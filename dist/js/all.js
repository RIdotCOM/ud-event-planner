"use strict";var App=function(){var e=this,t=new Firebase("https://event-creator.firebaseio.com/"),n=function(){var e=this,t={};this.registerElement=function(e){if(!t[e]){var n=document.getElementById(e),o={};return o.element=n,o.clickListeners=[],t[e]=o,o}},this.aClick=function(e,n){var o;t[e]||this.registerElement(e),o=t[e],console.log(o),o.clickListeners&&(o.clickListeners.map(function(e){o.element.removeEventListener("click",e)}),o.clickListeners=[]),o.element.addEventListener("click",n),o.clickListeners.push(n)},this.rClick=function(e,n){var o;o=t[e]?t[e]:registerElement(e),o.element.removeEventListener("click",n)},this.open=function(e){e.classList.add("opened")},this.close=function(e){e.classList.remove("opened")},this.show=function(e){e.classList.add("visible")},this.hide=function(e){e.classList.remove("visible")},this.attachEventsToInputs=function(){var t=[Ae,Ce,ke,ke,Te,Le,be],n=[$e,Qe,Xe,et,tt,ot,it];console.log(q),Array.prototype.forEach.call(q,function(e,n){var o=document.getElementById(e.id);console.log(o);var i=t[n];console.log(i),o.addEventListener("blur",i)}),console.log(F),Array.prototype.forEach.call(F,function(e,t){if(7>t){var o=document.getElementById(e.id),i=n[t];o.addEventListener("blur",i)}});var i=document.getElementsByClassName("hide-sign-in-overlay");Array.prototype.forEach.call(i,function(e,t){e.addEventListener("click",Pe)}),e.aClick("privacy-button",mt);var s=document.getElementsByClassName("logout-button")[0];s.addEventListener("click",function(){We(),o.hide(d),r.hide(),Qt.hideSideContainer()}),e.aClick("submit-button",Ie)}},o=new n,i=function(){var e=document.getElementById("fa");e.addEventListener("click",function(e){t.getAuth()?se():He()}),this.expand=function(){e.classList.add("expand-animation")},this.shrink=function(){e.classList.remove("expand-animation")},this.raiseLevel=function(){e.style.zIndex=200},this.lowerLevel=function(){e.style.zIndex=""}},s=new i,a=function(){var e=document.getElementById("main");this.show=function(){e.classList.add("visible")},this.hide=function(){e.classList.remove("visible")}},l=new a,c=function(){var e=document.getElementById("my-account");this.hide=function(){e.classList.remove("visible")},this.show=function(){e.classList.add("visible")},this.getElement=function(){return e}},r=new c,d=document.getElementById("overlay"),u=document.getElementsByTagName("body")[0],v=window.getComputedStyle(u,null).getPropertyValue("font-size"),m=u.clientHeight,h=parseFloat(v),f=function(){var e=document.getElementById("spinner");this.show=function(){e.classList.add("show")},this.hide=function(){e.classList.remove("show")}},g=new f,p=function(){var e,t=function(t){return e={},e.lat=t.coords.latitude,e.lng=t.coords.longitude,e};this.saveUserLocation=function(e){return t(e)},this.handleLocationError=function(e){return console.log(e),!1},this.getUserLoation=function(){return e?e:!1},this.determineUserLoation=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this.saveUserLocation,this.handleLocationError):alert("Geolocation is not supported by this browser")}},y=new p;y.getUserLoation()||y.determineUserLoation();var E=document.getElementById("error-container"),L=document.getElementById("sign-in"),b=document.getElementsByClassName("new-account-container")[0],w=document.getElementsByClassName("new-event-container")[0],k=(document.getElementById("event-overlay"),document.querySelector(".close-button"),document.getElementsByClassName("icon")[0]),I=document.getElementById("nav-overlay"),A=document.getElementById("faded-overlay"),T=document.getElementById("create-account"),C=document.getElementsByClassName("cancel-button"),B=document.getElementsByClassName("header")[0],N=document.getElementsByClassName("footer")[0],S=document.getElementById("nearby-list"),x=document.getElementById("closeby-list"),O=document.getElementById("faraway-list"),M=document.getElementsByClassName("nearby-button")[0],D=document.getElementsByClassName("closeby-button")[0],U=document.getElementsByClassName("faraway-button")[0],P=[S,x,O],H=document.getElementsByClassName("event-item")[0],V=document.getElementById("sign-in-form"),Y=document.getElementById("sign-in-overlay"),j=Y.querySelector("h2"),G=document.getElementById("pass"),q=(document.getElementById("retype-pass"),document.getElementById("new-account-form")),F=document.getElementById("new-event-form");console.log(M),M.addEventListener("click",function(){P.forEach(function(e){e.classList.remove("lefty"),e.classList.remove("left")})}),D.addEventListener("click",function(){P.forEach(function(e){e.classList.add("left"),e.classList.remove("lefty")})}),U.addEventListener("click",function(){P.forEach(function(e){e.classList.add("lefty")})});var W=function(){I.classList.remove("opened"),A.classList.remove("opened")};A.addEventListener("click",function(){W()}),k.addEventListener("click",function(){I.classList.add("opened"),A.classList.add("opened")});for(var z=function(){o.aClick("submit-button",Ie),o.aClick("next-button",ge),T.classList.add("aside"),l.show(),Qt.hideAll(),setTimeout(function(){T.classList.remove("aside"),d.classList.remove("visible"),b.classList.remove("visible","visibly"),w.classList.remove("visible","visibly"),B.classList.remove("visible"),N.classList.remove("visible"),d.classList.remove("from-left","visible","from-left-to-middle")},300)},R=C.length,_=0;R>_;_++)C[_].addEventListener("click",function(){z()});var Z=function(){var e;this.set=function(t){e=t},this.get=function(){return e},this.pixelsToMove=0},K=new Z,$=document.getElementById("event-view-close");$.addEventListener("click",function(e){location.hash="";var t=document.getElementById("effect");if(t.classList.contains("visible"))$.classList.remove("visible"),t.classList.remove("visible"),H.classList.add("move-away"),setTimeout(function(){H.classList.remove("move-away","visibly","visible"),H.children[1].classList.remove("visible"),H.children[2].classList.remove("visibly","visible")},600);else{H.children[2].style.transition="all .1s ease-in-out",H.children[2].style.opacity="0",H.classList.add("hide");var n=function(){H.classList.remove("hide","seen"),H.children[1].classList.remove("visible"),H.children[2].classList.remove("visibly","visible"),$.classList.remove("visible"),H.style.transition="",H.style.transform="",H.style.display="",H.style["z-index"]="",H.children[2].style.transition="",H.children[2].style.opacity=""};setTimeout(function(){H.style.transition="all .3s ease-in-out",H.style.transform="translateY("+K.pixelsToMove+"px)";var e=K.get();e&&(e.style.transform="translateY(0px)"),setTimeout(function(){n()},300)},900)}});var Q=function(){H.children[1].classList.add("visible"),H.children[2].classList.add("visible"),setTimeout(function(){H.children[2].classList.add("visibly")},1500),$.classList.add("visible")},X=function(e){s.raiseLevel(),setTimeout(function(){s.lowerLevel()},300),K.set(e);var t=e.getAttribute("data-id");location.hash="id="+t;var n=location.hash,o=n.substr(1).split("="),i=o.indexOf("id")+1,a=(o[i],e.getBoundingClientRect()),l=a.top;K.pixelsToMove=l,Tt(H,t,!0),H.style.transform="translateY("+l+"px )",H.classList.add("seen"),H.style.display="flex",H.style["z-index"]="100",e.style.transition="transform .3s ease-in-out",e.style.transform="translateY(0px )",Q();var c=-l;setTimeout(function(){H.style.transform="translateY(0px)",H.style.transition="all .3s ease-in-out"},0),e.style.transform="translateY("+c+"px)"},J=document.getElementsByClassName("event-item"),ee=new Hammer(S),te=new Hammer(x),ne=new Hammer(O),oe=new Hammer(I);oe.on("swipeleft",function(e){I.classList.remove("opened"),A.classList.remove("opened")}),ee.on("swipeleft",function(e){P.forEach(function(e){e.classList.add("left")})}),ee.on("swiperight",function(e){P.forEach(function(e){e.classList.remove("left")})}),te.on("swipeleft",function(e){P.forEach(function(e){e.classList.add("lefty")})}),te.on("swiperight",function(e){P.forEach(function(e){e.classList.remove("lefty"),e.classList.remove("left")})}),ne.on("swiperight",function(e){P.forEach(function(e){e.classList.remove("lefty")})});var ie=m-8*h;b.style.height=ie,b.style.minHeight=ie;var se=function(){me(!1),s.expand(),T.querySelector("h2").innerText="Create Event",o.aClick("submit-button",Lt),o.aClick("next-button",bt),o.show(d),w.classList.add("visibly"),o.show(B),o.show(N),setTimeout(function(){o.show(w),setTimeout(function(){s.shrink(),l.hide()},300)},200)},ae=document.getElementById("search-form"),le=document.getElementById("search-input"),ce=function(){le.blur()};ae.addEventListener("submit",ce);var re=document.getElementsByTagName("form"),de=function(e){for(var t=0;t<e.length;t++)for(var n=e[t].length,t=0;n>t;t++){var o=e[t];void 0!==o&&o.addEventListener("click",function(e){e.target.select()})}};de(re);var ue=E.querySelector("p"),ve=function(e){var t=function(e){ue.innerText=e,o.show(E),setTimeout(function(){o.hide(E)},3e3)};switch(e){case 1:console.log("pass too short"),t("Password too short");break;case 2:console.log("there is no number in pass"),t("Password doesn't contain number");break;case 3:console.log("there is no lowercase letter in pass"),t("Password doesn't contain lowercase letter");break;case 4:console.log("there is no UpperCase Letter in pass"),t("Password doesn't contain uppercase letter");break;case 5:console.log("passwords do not match"),t("Passwords do not match");break;case 6:console.log("invalid birthday"),t("Invalid Birthday");break;case 7:console.log("day is wrong"),t("Incorrect Day format");break;case 8:console.log("month is wrong"),t("Incorrect Month format");break;case 9:console.log("year is wrong"),t("Incorrect Year format");break;case 10:console.log("Invalid Characters in Name"),t("Name containes invalid characters");break;case 11:console.log("Invalid Email"),t("Invalid Email Address");break;case 12:console.log("Email Already in Use"),t("Email Already in Use");break;case 13:console.log("Account Successfully Created"),t("Account Successfully Created");break;case 14:console.log("Sign In Successful"),t("Sign In Successful");break;case 15:console.log("Incorrect email or password"),t("Incorrect email or password");break;case 16:console.log("Logged out"),t("Logged out");break;case 17:console.log("The specified user does not exist"),t("The specified user does not exist");break;case 18:console.log("Incorrect hour format"),t("Incorrect hour format");break;case 19:console.log("Incorrect minute format"),t("Incorrect minute format");break;case 20:console.log("Incorrect minute format"),t("Invalid event start date format");break;case 21:console.log("Incorrect minute format"),t("Invalid event end date format");break;case 22:console.log("No support for device location"),t("No support for device location");break;case 23:console.log("Invalid Date Format"),t("Invalid Date Format");break;case 24:console.log("Event Successfully Created"),t("Event Successfully Created");break;case 25:console.log("Event End Date Is Before Start Date"),t("Event End Date Is Before Start Date");break;case 26:console.log("Event End Time Is Before Start Time"),t("Event End Time Is Before Start Time");break;case 27:console.log("Event Cannot Start Before Today"),t("Event Cannot Start Before Today");break;case 28:console.log("You are already attending this event"),t("You are already attending this event");break;case 30:console.log("Location Have not been filled"),t("Location Have not been filled");break;case 31:console.log("Please Enter the Start Time First"),t("Please Enter the Start Time First");break;case 32:console.log("Please Enter the Start Time"),t("Please Enter the Start Time");break;case 33:console.log("Please Enter the End Time"),t("Please Enter the End Time");break;case 34:console.log("Guestlist contains invalid email"),t("Guestlist contains invalid email")}},me=function(e){var t=document.getElementsByClassName("footer")[0];if(console.dir(t),e)for(var n=0;2>n;n++)t.children[1].children[n].classList.add("visible");else for(var n=0;2>n;n++)t.children[1].children[n].classList.remove("visible")},he=document.getElementById("reset-fields"),fe=function(){he.children[0].classList.add("rotate"),setTimeout(function(){he.children[0].classList.remove("rotate")},500);var e=d.querySelector("h2");if("NEW ACCOUNT"===e.innerText){for(var t=q.length,n=0;t>n;n++){var o=q.children[n];o.value=""}Ee={}}else{for(var t=F.length,i=0;t>i;i++){var o=F.children[i];o.value=""}Ke={}}};he.addEventListener("click",function(){fe()});var ge=function(e){pe(!0);for(var t=0;6>t;t++){var e=q[t];if(""===e.value)return 0===t?q[t+1].scrollIntoView(!1):q[t-1].scrollIntoView(!0),void e.focus()}},pe=function(e){if(e){for(var t=0;5>t;t++){var n=q[t];if(""===n.value)return void me(!1)}me(!0)}else me(!1)},ye=function(e,t){t?""!==F[e].value&&(Ke[e]=F[e].value):""!==q[e].value&&(Ee[e]=q[e].value)},Ee={},Le=function(){ye("employer",!1)},be=function(){ye("jobtitle",!1)},we=function(e){if(0===e.length)return!1;if(e.length<6)return ve(1),G.select(),!1;var t=/[0-9]/;return t.test(e)?(t=/[a-z]/,t.test(e)?(t=/[A-Z]/,t.test(e)?!0:(console.log("there is no UpperCase Letter"),ve(4),G.select(),!1)):(console.log("there is no lowercase letter"),ve(3),G.select(),!1)):(console.log("there is no number"),ve(2),G.select(),!1)},ke=function(){var e=!1;""===q["retype-pass"].value?e=we(q.pass.value):q.pass.value!==q["retype-pass"].value?(console.log("passwords do not match"),q["retype-pass"].value="",q["retype-pass"].select(),ve(5)):(ye("pass",!1),e=!0),pe(e?!0:!1)},Ie=function(){g.show(),Object.keys(Ee).map(function(e){Ee[e].trim()});var e={};e.email=Ee.email,e.password=Ee.pass,t.createUser(e,function(n,o){n?(console.log(n),ve(12)):(console.log(o),t.authWithPassword(e,function(e,n){if(e)console.log(e);else{console.log(n);var o=n.auth.uid;delete Ee.email,delete Ee.pass;var i={info:Ee,events:["true"]};t.child("users").child(o).set(i,function(e,t){e?console.log("error"):(z(),Qt.active&&Qt.hideAll(),Ye(),fe(),Ee={},g.hide(),ve(13))})}}))})},Ae=function(){var e=q.name.value,t=/^[a-zA-Z\s]+$/;return 0!==e.length&&t.test(e)?(ye("name",!1),!0):0===e.length?!1:(q.name.select(),console.log("Invalid Characters"),ve(10),void 0)},Te=function(){var e=q.birthday.value,t=e.length;if(0===t)return void pe(!1);var n=function(e){var t=/^\d+$/;return console.log(t.test(e)),t.test(e)?!0:!1},o=function(e){var t=e,n=t.substr(6,2);if(console.log(n),n>0&&31>=n){var o=t.substr(4,2);if(console.log(o),o>0&&12>=o){var i=t.substr(0,4);console.log(i);var s=new Date,a=s.getFullYear()-100,l=s.getFullYear()-13;return i>=a&&l>=i?(console.log("OK"),void console.log(t)):(console.log("year is wrong"),q.birthday.select(),q.birthday.focus(),void ve(9))}return console.log("month is wrong"),q.birthday.select(),void ve(8)}return console.log("day is wrong"),q.birthday.select(),void ve(7)};if(8===t)n(e)?o(e):(ve(6),q.birthday.select());else{if(10!==t)return console.log("its all wrong"),q.birthday.select(),ve(6),void pe(!1);var i=function(t){var n=t.split("-").join("");return e=n,n};n(i(e))?o(e):(ve(6),q.birthday.select())}pe(!0),ye("birthday",!1)},Ce=function(){var e=q.email.value,t=e.length;if(0===t)return void pe(!1);if(6>=t)ve(11),q.email.select();else{var n=e.split("@");if(2===n.length){var o=n[1].split("."),t=o.length;2===t||3===t?(pe(!0),ye("email",!1)):(ve(11),q.email.select())}else ve(11),q.email.select()}},Be=function(){var e=d.querySelector("h2");return e.innerText="New Account",o.close(I),o.close(A),Qt.active?void Qt.showNewAccount():(d.classList.add("from-left","visible"),void setTimeout(function(){d.classList.add("from-left-to-middle"),b.classList.add("visibly"),o.show(B),o.show(N),setTimeout(function(){o.show(b)},200),setTimeout(function(){l.hide()},300)},100))},Ne=document.getElementById("sign-up-button");Ne.addEventListener("click",function(){Pe(),setTimeout(function(){Be()},300)});var Se=function(){o.hide(d),r.hide(),o.hide($),$.removeAttribute("onclick","")},xe=function(e){var t=e,n=document.createElement("li");return n.innerText=t["event-name"],n.addEventListener("click",function(){rt=t.id,location.hash="#id="+rt,Ot()}),console.log(n),n},Oe=document.getElementById("user-events"),Me=function(e){var n=e,o=dt[n];o?Oe.appendChild(xe(o)):(console.log("GETTING UNLISTED EVENT"),t.child("events/unlisted").child(n).once("value",function(e){e.val()&&(console.log(e.val()),dt[e.val().id]=e.val(),Oe.appendChild(xe(e.val())))}))},De=!1,Ue=function(){W(),o.show(d),r.show(),o.show($),$.addEventListener("click",Se),De||t.child("users").child(t.getAuth().uid).once("value",function(e){console.log(e.val());var t=e.val().events;r.getElement().querySelector("h2").innerText=e.val().info.name,t.map(function(e){"true"!==e&&(console.log(e),Me(e))}),De=!0})},Pe=function(){A.removeEventListener("click",Pe),A.classList.remove("opened"),o.hide(Y),console.dir("sign in hide")},He=function(){console.log("HELLO"),W(),A.addEventListener("click",Pe),setTimeout(function(){o.open(A)},300),o.show(Y),V.email.focus(),console.dir("sign in show")},Ve=function(e){var n=e.token;t.authWithCustomToken(n,function(e,t){e?console.log("Login Failed!",e):(ve(14),console.log("Authenticated successfully with payload:",t))})},Ye=function(){L.children[0].lastChild.data="My Account",L.removeEventListener("click",He),L.addEventListener("click",Ue)},je=function(){j.removeEventListener("click",je),j.classList.remove("button");var e={};e.email=V.email.value,e.password=V.password.value,g.show(),t.authWithPassword(e,function(e,n){if(e){switch(e.code){case"INVALID_USER":ve(17);break;case"INVALID_PASSWORD":ve(15)}Ze(),g.hide()}else{g.hide(),Pe(),Ze(),Ye(),ve(14);var o=828e5;setInterval(function(){Ve(t.getAuth().token)},o)}})},Ge=function(){""!==V.email.value&&(V.password.value.length>=6?(j.classList.add("button"),j.addEventListener("click",je)):(j.classList.remove("button"),j.removeEventListener("click",je)))},qe=function(){j.focus()},Fe=document.getElementById("password");Fe.addEventListener("keyup",Ge),Fe.addEventListener("blur",qe);var We=function(){W(),t.unauth(),L.children[0].lastChild.data="Sign In",L.removeEventListener("click",Ue),L.addEventListener("click",He),setTimeout(function(){ve(16)},300)};this.signOut=We;var ze=document.getElementById("dismiss-error");ze.addEventListener("click",function(){o.hide(E)});var Re,_e,Ze=function(){for(var e=V.length,t=0;e>t;t++){var n=V[t];n.value=""}},Ke={},$e=function(){console.log("PROCESS EVENT NAME");var e="event-name";ye(e,!0)},Qe=function(){var e="event-type";ye(e,!0)},Xe=function(){var e="host";ye(e,!0)},Je=function(e){console.log("dateTimeCheck");var t;if(t=e?F["event-start-time"].value:F["event-end-time"].value,""!==t){var n=Date.parse(t),o=Date.now();if(e){if(!(n>o))return ve(27),F["event-start-time"].select(),void F["event-start-time"].focus();Ke["event-start-time"]=n}else{var i=F["event-start-time"].value;if(""!==i){var s=Date.parse(i);if(!(n>s))return ve(25),F["event-end-time"].select(),void F["event-end-time"].focus();Ke["event-end-time"]=n}else ve(31)}}else e?Ke["event-start-time"]="":Ke["event-end-time"]=""},et=function(){Je(!0)},tt=function(){Je()},nt=function(e){var t=e.split("@");if(2===t.length){var n=t[1].split(".");console.log(n);var o=n.length;return 2===o||3===o?!0:!1}return!1},ot=function(){console.log("process GuestList");var e=F.guestlist.value,t=e.split(",");console.log(t),t=t.map(function(e){var e=e.trim();return nt(e)?e:void ve(34)}),Ke["guest-list-invitations"]=t},it=function(){var e=F.message.value;e&&(Ke["message-for-guests"]=e)},st=function(e,t){var n=e,o=t;console.log(e),Ke["event-location-data"]={},Ke["event-location-data"].name=o,Ke["event-location-data"].address=n.formatted_address,Ke["event-location-data"].lat=n.geometry.location.lat(),Ke["event-location-data"].lng=n.geometry.location.lng()},at=F["google-event-location"],lt=function(){var e=Re.getPlace();e.types.length>1?at.value=e.name:at.value=e.address_components[1].long_name+" "+e.address_components[0].long_name;var t=at.value;st(e,t)},ct=function(){console.log(_e),void 0!==_e&&(google.maps.event.removeListener(_e),_e=void 0),Re=new google.maps.places.Autocomplete(at),_e=google.maps.event.addListener(Re,"place_changed",lt)};e.initAutocomplete=ct;var rt,dt,ut,vt=!0,mt=function(){var e=w.querySelector("#privacy-button"),t=e.children[0];t.classList.toggle("off"),vt=vt?!vt:!vt},ht=function(e){var t=dt[e]["event-location-data"].lat,n=dt[e]["event-location-data"].lng,o=y.getUserLoation().lat,i=y.getUserLoation().lng,s=t-o,a=n-i;return.1>s&&s>-.1&&.1>a&&a>-.1?(console.log("EVENT IS NEARBY"),S):.3>s&&s>-.3&&.3>a&&a>-.3?(console.log("EVENT IS CLOSEBY"),x):(console.log("EVENT IS FARAWAY"),O)},ft=function(){var e=document.getElementById("info"),t=e.children[0],n=H.cloneNode(!0);n=Tt(n,id,!1,!0),n.children[0].setAttribute("style",""),n.addEventListener("click",function(){Qt.moveInfoToView(id);var t={};t.lat=dt[id]["event-location-data"].lat,t.lng=dt[id]["event-location-data"].lng,Zt.map.setCenter(t),e.classList.contains("expand")&&e.classList.remove("expand"),console.log(e),console.log(e.children),console.log(e.children[0].children[index]),Array.prototype.forEach.call(e.children[0].children,function(e){console.log(e),e.classList.remove("selected")}),e.children[0].children[index].classList.add("selected")}),t.appendChild(n),eventElements.push(n)},gt=function(e){var t,n=H.cloneNode(!0);Tt(n,e),Qt.active?ft():(t=ht(e),t.appendChild(n),kt())},pt=function(e,n){t.child("users").child(e).once("value",function(o){if(o.val()){var i=o.val().events;-1===i.indexOf(n)&&(i.push(n),t.child("users").child(e).update({events:i}))}})},yt=function(n){g.show();var o=Ke["guest-list-invitations"],i=Ke["message-for-guests"];if(delete Ke["guest-list-invitations"],delete Ke["message-for-guests"],!o)return ve(34),void g.hide();if(Ke.privacy){console.log("save to private events");var s=t.child("events/unlisted").push(Ke,function(e,a){if(e)console.dir(e);else{var l=s.key();t.child("events/unlisted").child(l).update({id:l},function(e,t){e?console.dir(e):g.hide()}),ve(24),Ke=new Object,n.id=l,dt[l]=n,pt(t.getAuth().uid,l),gt(l),on(l,o,i)}})}else{console.log("save to public events");var s=t.child("events/public").push(Ke,function(a,l){if(a)console.dir(a);else{var c=s.key();t.child("events/public").child(c).update({id:c},function(e,t){e?console.dir(e):g.hide()}),ve(24),Ke=new Object,n.id=c,dt[c]=n,pt(t.getAuth().uid,c),gt(c);var r={};r.lat=dt[c]["event-location-data"].lat,r.lng=dt[c]["event-location-data"].lng;var d=new google.maps.Marker({position:r,map:Zt.map,animation:google.maps.Animation.DROP});d.addListener("click",function(){e.map.setCenter(r),Qt.moveInfoToView(key),console.log(key)}),gt(c),on(c,o,i)}})}},Et=!1,Lt=function(){if(console.log("SUBMITTING NEW EVENT!"),!Et){if(!Ke["event-location-data"]||!Ke["event-location-data"].lat)return ve(30),void g.hide();Et=!0,z(),Qt.active&&Qt.hideAll(),Ke.privacy=vt,Ke["guest-count"]=1,Ke.guests=[],Ke.guests.push(t.getAuth().uid),Object.keys(Ke).map(function(e){"string"==typeof Ke[e]&&(Ke[e]=Ke[e].trim())}),console.log(Ke),yt(Ke),fe(),Et=!1}},bt=function(e){console.log("FOCUS NEXT ELEMENT");for(var t=[F["event-name"],F["event-start-time"],F["event-end-time"],F["google-event-location"]],n=t.length,o=0;n>o;o++)if(""===t[o].value)return t[o].scrollIntoView(!0),void t[o].focus();wt()},wt=function(e){console.log("CHECK IF NEW EVENT READY FOR SUBMIT");for(var t=[F["event-name"],F["event-start-time"],F["event-end-time"],F.guestlist,F["google-event-location"]],n=t.length,o=0;n>o;o++){var i=t[o];if(""===i.value)return void me(!1)}me(!0)},kt=function(){1===S.children.length?o.show(S.children[0]):o.hide(S.children[0]),1===x.children.length?o.show(x.children[0]):o.hide(x.children[0]),1===O.children.length?o.show(O.children[0]):o.hide(O.children[0]),console.dir(S.children.length),console.dir(x),console.dir(O)},It=function(e){for(var t=e,n=Object.keys(t),i=n.length,s=0;i>s;s++){var a=n[s],l=t[a];Bt(l)}var c=u.offsetWidth;c>=426&&(console.log("TIME TO LOAD GOOGLE MAP!"),Zt.load(),Qt.load()),o.attachEventsToInputs(),kt(),g.hide()},At=function(e){if(null===t.getAuth())return!1;var n=t.getAuth().uid,o=dt[e].guests;return-1!==o.indexOf(n)?!0:!1},Tt=function(e,t,n,o){var i=dt[t],s=i["event-location-data"].lat,a=i["event-location-data"].lng,l=s-2e-4,c=a-9e-4,r=en(),d=r.height,u=r.width,v="https://maps.googleapis.com/maps/api/staticmap?center="+l+","+c+"&zoom=17&markers=color:red%7C"+s+","+a+"&size="+u+"x"+d+"&maptype=roadmap&key=AIzaSyBPSBuZde1QlCpGe7IhH674CWPSFSDTknk";e.children[0].style.backgroundImage="url("+v+")";var m=e.querySelector("h2");m.innerHTML=i["event-name"]+"<span></span>";var h=e.querySelector("ul"),f=new Date(i["event-start-time"]),g=new Date(i["event-end-time"]);if(h.children[0].innerText="Start: "+f.getHours()+":"+f.getMinutes()+" / "+f.getDate()+"."+f.getMonth()+"1."+f.getYear(),h.children[1].innerText="End: "+g.getHours()+":"+g.getMinutes()+" / "+g.getDate()+"."+g.getMonth()+"1."+g.getYear(),h.children[2].innerText="Place: "+i["event-location-data"].name,e.setAttribute("data-id",i.id),n){var p=e.querySelector(".head");p.innerHTML="<h2>"+i["event-name"]+"</h2>";var y=e.querySelector(".wrapper"),E=y.children[0].children[1];E.innerHTML="<span>"+i["event-location-data"].address+"</span>";var L=y.children[0].children[3];L.innerHTML="<span>"+i["guest-count"]+"</span>";var b=y.children[1].children[0].children[0];At(t)?b.innerText="Attending!":b.innerText="Attending?"}else if(!o){e.addEventListener("click",function(){X(e)});var w=e.querySelector(".share-icon");w.addEventListener("click",function(){on(t)})}return e},Ct=document.getElementsByClassName("event-item")[0],Bt=function(e){var t=e.id,n=e["event-location-data"].lat,o=e["event-location-data"].lng,i=(y.getUserLoation(),y.getUserLoation().lat),s=y.getUserLoation().lng,a=n-i,l=o-s,c=Ct.cloneNode(!0);Tt(c,t),.1>a&&a>-.1&&.1>l&&l>-.1?(console.log("EVENT IS NEARBY"),S.appendChild(c)):.3>a&&a>-.3&&.3>l&&l>-.3?(console.log("EVENT IS CLOSEBY"),x.appendChild(c)):(console.log("EVENT IS FARAWAY"),O.appendChild(c))},Nt=function(){var e=location.hash,t=e.substr(1).split("="),n=t.indexOf("id")+1;if(0!==n){var o=t[n];return rt=o,!0}return!1},St=function(){setTimeout(function(){Q()},600),H.classList.add("visibly","visible")},xt=document.getElementById("effect"),Ot=function(){o.show(xt),setTimeout(function(){Tt(H,rt,!0),St()},300)},Mt=function(){var e,t=!1;e=setInterval(function(){console.log("RUNNING INTERVAL"),void 0!==dt&&Nt()&&!t&&(Ot(),t=!0),y.getUserLoation()&&void 0!==dt&&(clearInterval(e),It(dt))},500)},Dt=[],Ut=function(){ut=Object.keys(dt),ut.map(function(e){Dt.push(dt[e]["event-name"])})},Pt=[],Ht=document.getElementById("search-results"),Vt=document.getElementById("search-notification"),Yt=function(e){0!==e.length?(o.show(Vt),e.map(function(e){var t=ut[e];if(-1===Pt.indexOf(t)){var n=H.cloneNode(!0);Tt(n,t),Ht.appendChild(n),Pt.push(t)}})):0!==Pt.length&&jt(!0)},jt=function(e){Ht.innerHTML="",Pt=[],Vt.classList.remove("visible"),e||(le.value="")},Gt=document.getElementById("clear-search");Gt.addEventListener("click",function(){jt()});var qt=document.getElementById("search-input"),Ft=function(){var e=qt.value.toLowerCase(),t=[];Dt.map(function(n,o){e===n.toLowerCase()&&t.push(o)}),Yt(t)};qt.addEventListener("keyup",Ft);var Wt=function(){g.show(),Mt(),t.child("events/public").once("value",function(e){null!==e.val()?(dt=e.val(),Ut()):dt={}})};Wt();var zt,Rt=function(){var e=document.getElementById("info");this.show=function(){e.classList.add("opened")}},_t=(new Rt,function(){var e=this;this.map,this.load=function(){if(!this.map){console.log("LOADING GOOGLE MAP!"),this.map=new google.maps.Map(document.getElementById("map"),{center:{lat:y.getUserLoation().lat,lng:y.getUserLoation().lng},zoom:8}),console.log(dt);var t=Object.keys(dt);t.map(function(t){var n={};n.lat=dt[t]["event-location-data"].lat,n.lng=dt[t]["event-location-data"].lng;var o=new google.maps.Marker({position:n,map:e.map,animation:google.maps.Animation.DROP});o.addListener("click",function(){e.map.setCenter(n),Qt.moveInfoToView(t),console.log(t)})}),Array.prototype.map.call(dt,function(e){console.log(e)})}}}),Zt=new _t,Kt=function(){this.getEventLocation=function(e){var t={};return t.lat=dt[e]["event-location-data"].lat,t.lng=dt[e]["event-location-data"].lng,t}},$t=(new Kt,function(){var e,n=this,i=document.getElementById("overlay"),s=document.getElementById("side-container"),a=document.getElementById("info"),l=a.children[0],c="",r=a.children[1],v=a.children[2],m=a.children[3],h=[],s=document.getElementById("side-container"),f=document.getElementById("map");m.addEventListener("click",function(){a.classList.add("opened")}),r.addEventListener("click",function(){a.classList.remove("opened")}),v.addEventListener("click",function(){a.classList.toggle("expand"),a.classList.contains("expand")&&""!==l.style.transform?l.style.transform="":l.style.transform=c}),this.active=!1;var g=!1;this.load=function(){if(!g){g=!0,this.active=!0,e=Object.keys(dt),Array.prototype.map.call(e,function(e,t){var o=H.cloneNode(!0);o=Tt(o,e,!1,!0),o.children[0].setAttribute("style",""),o.addEventListener("click",function(){n.moveInfoToView(e);var o={};o.lat=dt[e]["event-location-data"].lat,o.lng=dt[e]["event-location-data"].lng,Zt.map.setCenter(o),a.classList.contains("expand")&&a.classList.remove("expand"),console.log(a),console.log(a.children),console.log(a.children[0].children[t]),Array.prototype.forEach.call(a.children[0].children,function(e){console.log(e),e.classList.remove("selected")}),a.children[0].children[t].classList.add("selected")}),l.appendChild(o),h.push(o)});var t=document.getElementsByClassName("open-new-account-button")[0],o=document.getElementsByClassName("open-new-event-button")[0];t.addEventListener("click",n.openMyAccount),o.addEventListener("click",n.createNewEvent)}},this.unload=function(){console.log("please remove and reattach overlay elements to dom, thank you"),u.appendChild(d),s.removeChild(i)},this.moveInfoToView=function(t){var n=e.indexOf(t);console.log(n),c="translateY(-"+100*n+"%)",l.style.transform=c,console.log(l),console.log(l.style),console.log(l.style.transform)};var p=d.getElementsByClassName("new-account-container")[0],y=d.getElementsByClassName("new-event-container")[0];this.hideAll=function(){o.hide(p),o.hide(y),o.hide(E),o.hide(L),o.hide(d),f.classList.remove("aside")},this.openSideContainer=function(){d.classList.add("visible"),f.classList.add("aside")},this.hideSideContainer=function(){d.classList.remove("visible"),f.classList.remove("aside"),n.hideAll()};var E=document.getElementById("my-account");this.showMyAccount=function(){o.show(E)},this.hideMyAccount=function(){o.hide(E)};var L=document.getElementById("create-account");this.hideCreateAccount=function(){o.hide(L)},this.showCreateAccount=function(){o.show(L)},this.showNewAccount=function(){d.classList.contains("visible")?n.hideSideContainer():(n.hideAll(),n.openSideContainer(),n.showCreateAccount(),o.show(p),n.hideMyAccount())},this.openMyAccount=function(){d.classList.contains("visible")?n.hideSideContainer():t.getAuth()?(n.hideAll(),n.openSideContainer(),n.showMyAccount(),Ue()):He()},this.openNewAccount=function(){d.classList.contains("visible")?n.hideSideContainer():t.getAuth()?(n.hideAll(),n.openSideContainer(),n.showMyAccount(),Ue()):He()},this.createNewEvent=function(){d.classList.contains("visible")?n.hideSideContainer():t.getAuth()?(n.hideAll(),n.openSideContainer(),n.hideMyAccount(),n.showCreateAccount(),se()):He()}}),Qt=new $t,u=document.getElementsByTagName("body")[0],Xt=function(){clearTimeout(zt),zt=setTimeout(function(){var e=u.offsetWidth;e>=426?(console.log("TIME TO LOAD GOOGLE MAP!"),Zt.load(),Qt.load()):Jt()},500)},Jt=function(){var e=J;Array.prototype.forEach.call(e,function(e){var t=e.getAttribute("data-id");null!==t&&Tt(e,t)})},en=function(){H.style.display="flex",H.style.paddingBottom="0px";var e=H.children[0].offsetHeight,t=H.children[0].offsetWidth;return H.style.display="",H.style.paddingBottom="",{height:e,width:t}};window.onresize=Xt;var tn=function(){if(t.getAuth()){var e=H.querySelector(".guest-count").children[0],n=H.getAttribute("data-id");
if(-1===dt[n].guests.indexOf(t.getAuth().uid)){var o=parseInt(e.innerText),i=o+1;if(e.innerText=i,dt[n]["guest-count"]=i,!dt[n].privacy){var s=dt[n].guests.push(t.getAuth().uid),a={};a["guest-count"]=s.length,a.guests=s,t.child("events/public").child(n).update(a,function(e){e?(console.log("error"),console.log(e)):console.log("DONE!")})}}else ve(28)}else He();console.dir(H.querySelector(".guest-count").children[0].innerText)},nn=document.getElementById("attend-event");nn.addEventListener("click",tn);var on=function(e,t,n){var o=e,i=dt[e]["event-name"],s=location.origin+"/#id="+o;if(t){var a=t.join(","),l=n;window.open("mailto:"+a+"?subject=Checkout This Event!&body="+l+", - Don't be shy and joing us at this '"+i+"' event! ---> "+s)}else window.open("mailto:xyz@abc.com?subject=Checkout This Event!&body=Hey, don't be shy and joing us at this '"+i+"' event! ---> "+s)},sn=function(){var e=H.getAttribute("data-id"),t=dt[e]["event-name"],n=location.href;window.open("mailto:xyz@abc.com?subject=Checkout This Event!&body=Hey, don't be shy and joing us at this '"+t+"' event! ---> "+n)},an=document.getElementById("email-guests");if(an.addEventListener("click",sn),t.getAuth()){L.children[0].lastChild.data="My Account",L.addEventListener("click",Ue),t.authWithCustomToken(t.getAuth().token,function(e,t){e||console.log("AUTHENTICATED")});var ln=828e5;setInterval(function(){t.authWithCustomToken(t.getAuth().token,function(e,t){e||console.log("horay")})},ln)}else L.addEventListener("click",He)},app=new App,initAutocomplete=app.initAutocomplete;