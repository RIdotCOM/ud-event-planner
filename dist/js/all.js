"use strict";var App=function(){var e=this,t=new Firebase("https://event-creator.firebaseio.com/"),n=function(){var e=this,t={};this.registerElement=function(e){if(!t[e]){var n=document.getElementById(e),i={};return i.element=n,i.clickListeners=[],t[e]=i,i}},this.aClick=function(e,n){var i;t[e]||this.registerElement(e),i=t[e],i.clickListeners&&(i.clickListeners.map(function(e){i.element.removeEventListener("click",e)}),i.clickListeners=[]),i.element.addEventListener("click",n),i.clickListeners.push(n)},this.rClick=function(e,n){var i;i=t[e]?t[e]:registerElement(e),i.element.removeEventListener("click",n)},this.open=function(e){e.classList.add("opened")},this.close=function(e){e.classList.remove("opened")},this.show=function(e){e.classList.add("visible")},this.hide=function(e){e.classList.remove("visible")},this.attachEventsToInputs=function(){var t=[Ae,Be,ke,ke,Ce,Ee,be],n=[Qe,Je,Ke,et,tt,it,at];Array.prototype.forEach.call(V,function(e,n){var i=document.getElementById(e.id),a=t[n];i.addEventListener("blur",a)}),Array.prototype.forEach.call(W,function(e,t){if(t<7){var i=document.getElementById(e.id),a=n[t];i.addEventListener("blur",a)}});var a=document.getElementsByClassName("hide-sign-in-overlay");Array.prototype.forEach.call(a,function(e,t){e.addEventListener("click",Pe)}),e.aClick("privacy-button",mt);var s=document.getElementsByClassName("logout-button")[0];s.addEventListener("click",function(){Fe(),i.hide(d),r.hide(),Jt.hideSideContainer()}),e.aClick("submit-button",Ie)}},i=new n,a=function(){var e=document.getElementById("fa");e.addEventListener("click",function(e){t.getAuth()?se():qe()}),this.expand=function(){e.classList.add("expand-animation")},this.shrink=function(){e.classList.remove("expand-animation")},this.raiseLevel=function(){e.style.zIndex=200},this.lowerLevel=function(){e.style.zIndex=""}},s=new a,o=function(){var e=document.getElementById("main");this.show=function(){e.classList.add("visible")},this.hide=function(){e.classList.remove("visible")}},c=new o,l=function(){var e=document.getElementById("my-account");this.hide=function(){e.classList.remove("visible")},this.show=function(){e.classList.add("visible")},this.getElement=function(){return e}},r=new l,d=document.getElementById("overlay"),u=document.getElementsByTagName("body")[0],v=window.getComputedStyle(u,null).getPropertyValue("font-size"),m=u.clientHeight,h=parseFloat(v),f=function(){var e=document.getElementById("spinner");this.show=function(){e.classList.add("show")},this.hide=function(){e.classList.remove("show")}},g=new f,p=function(){var e,t=function(t){return e={},e.lat=t.coords.latitude,e.lng=t.coords.longitude,e};this.saveUserLocation=function(e){return t(e)},this.handleLocationError=function(e){return!1},this.getUserLoation=function(){return!!e&&e},this.determineUserLoation=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this.saveUserLocation,this.handleLocationError):alert("Geolocation is not supported by this browser")}},y=new p;y.getUserLoation()||y.determineUserLoation();var L=document.getElementById("error-container"),E=document.getElementById("sign-in"),b=document.getElementsByClassName("new-account-container")[0],w=document.getElementsByClassName("new-event-container")[0],k=(document.getElementById("event-overlay"),document.querySelector(".close-button"),document.getElementsByClassName("icon")[0]),I=document.getElementById("nav-overlay"),A=document.getElementById("faded-overlay"),C=document.getElementById("create-account"),B=document.getElementsByClassName("cancel-button"),T=document.getElementsByClassName("header")[0],x=document.getElementsByClassName("footer")[0],S=document.getElementById("nearby-list"),N=document.getElementById("closeby-list"),M=document.getElementById("faraway-list"),D=document.getElementsByClassName("nearby-button")[0],O=document.getElementsByClassName("closeby-button")[0],j=document.getElementsByClassName("faraway-button")[0],P=[S,N,M],q=document.getElementsByClassName("event-item")[0],H=document.getElementById("sign-in-form"),U=document.getElementById("sign-in-overlay"),z=U.querySelector("h2"),Y=document.getElementById("pass"),V=(document.getElementById("retype-pass"),document.getElementById("new-account-form")),W=document.getElementById("new-event-form");D.addEventListener("click",function(){P.forEach(function(e){e.classList.remove("lefty"),e.classList.remove("left")})}),O.addEventListener("click",function(){P.forEach(function(e){e.classList.add("left"),e.classList.remove("lefty")})}),j.addEventListener("click",function(){P.forEach(function(e){e.classList.add("lefty")})});var F=function(){I.classList.remove("opened"),A.classList.remove("opened")};A.addEventListener("click",function(){F()}),k.addEventListener("click",function(){I.classList.add("opened"),A.classList.add("opened")});for(var _=function(){i.aClick("submit-button",Ie),i.aClick("next-button",ge),C.classList.add("aside"),c.show(),Jt.hideAll(),setTimeout(function(){C.classList.remove("aside"),d.classList.remove("visible"),b.classList.remove("visible","visibly"),w.classList.remove("visible","visibly"),T.classList.remove("visible"),x.classList.remove("visible"),d.classList.remove("from-left","visible","from-left-to-middle")},300)},R=B.length,G=0;G<R;G++)B[G].addEventListener("click",function(){_()});var Z=function(){var e;this.set=function(t){e=t},this.get=function(){return e},this.pixelsToMove=0},$=new Z,Q=document.getElementById("event-view-close");Q.addEventListener("click",function(e){location.hash="";var t=document.getElementById("effect");if(t.classList.contains("visible"))Q.classList.remove("visible"),t.classList.remove("visible"),q.classList.add("move-away"),setTimeout(function(){q.classList.remove("move-away","visibly","visible"),q.children[1].classList.remove("visible"),q.children[2].classList.remove("visibly","visible")},600);else{q.children[2].style.transition="all .1s ease-in-out",q.children[2].style.opacity="0",q.classList.add("hide");var n=function(){q.classList.remove("hide","seen"),q.children[1].classList.remove("visible"),q.children[2].classList.remove("visibly","visible"),Q.classList.remove("visible"),q.style.transition="",q.style.transform="",q.style.display="",q.style["z-index"]="",q.children[2].style.transition="",q.children[2].style.opacity=""};setTimeout(function(){q.style.transition="all .3s ease-in-out",q.style.transform="translateY("+$.pixelsToMove+"px)";var e=$.get();e&&(e.style.transform="translateY(0px)"),setTimeout(function(){n()},300)},900)}});var J=function(){q.children[1].classList.add("visible"),q.children[2].classList.add("visible"),setTimeout(function(){q.children[2].classList.add("visibly")},1500),Q.classList.add("visible")},K=function(e){s.raiseLevel(),setTimeout(function(){s.lowerLevel()},300),$.set(e);var t=e.getAttribute("data-id");location.hash="id="+t;var n=location.hash,i=n.substr(1).split("="),a=i.indexOf("id")+1,o=(i[a],e.getBoundingClientRect()),c=o.top;$.pixelsToMove=c,Ct(q,t,!0),q.style.transform="translateY("+c+"px )",q.classList.add("seen"),q.style.display="flex",q.style["z-index"]="100",e.style.transition="transform .3s ease-in-out",e.style.transform="translateY(0px )",J();var l=-c;setTimeout(function(){q.style.transform="translateY(0px)",q.style.transition="all .3s ease-in-out"},0),e.style.transform="translateY("+l+"px)"},X=document.getElementsByClassName("event-item"),ee=new Hammer(S),te=new Hammer(N),ne=new Hammer(M),ie=new Hammer(I);ie.on("swipeleft",function(e){I.classList.remove("opened"),A.classList.remove("opened")}),ee.on("swipeleft",function(e){P.forEach(function(e){e.classList.add("left")})}),ee.on("swiperight",function(e){P.forEach(function(e){e.classList.remove("left")})}),te.on("swipeleft",function(e){P.forEach(function(e){e.classList.add("lefty")})}),te.on("swiperight",function(e){P.forEach(function(e){e.classList.remove("lefty"),e.classList.remove("left")})}),ne.on("swiperight",function(e){P.forEach(function(e){e.classList.remove("lefty")})});var ae=m-8*h;b.style.height=ae,b.style.minHeight=ae;var se=function(){me(!1),s.expand(),C.querySelector("h2").innerText="Create Event",i.aClick("submit-button",Et),i.aClick("next-button",bt),i.show(d),w.classList.add("visibly"),i.show(T),i.show(x),setTimeout(function(){i.show(w),setTimeout(function(){s.shrink(),c.hide()},300)},200)},oe=document.getElementById("search-form"),ce=document.getElementById("search-input"),le=function(){ce.blur()};oe.addEventListener("submit",le);var re=document.getElementsByTagName("form"),de=function(e){for(var t=0;t<e.length;t++)for(var n=e[t].length,t=0;t<n;t++){var i=e[t];void 0!==i&&i.addEventListener("click",function(e){e.target.select()})}};de(re);var ue=L.querySelector("p"),ve=function(e){var t=function(e){ue.innerText=e,i.show(L),setTimeout(function(){i.hide(L)},3e3)};switch(e){case 1:t("Password too short");break;case 2:t("Password doesn't contain number");break;case 3:t("Password doesn't contain lowercase letter");break;case 4:t("Password doesn't contain uppercase letter");break;case 5:t("Passwords do not match");break;case 6:t("Invalid Birthday");break;case 7:t("Incorrect Day format");break;case 8:t("Incorrect Month format");break;case 9:t("Incorrect Year format");break;case 10:t("Name containes invalid characters");break;case 11:t("Invalid Email Address");break;case 12:t("Email Already in Use");break;case 13:t("Account Successfully Created");break;case 14:t("Sign In Successful");break;case 15:t("Incorrect email or password");break;case 16:t("Logged out");break;case 17:t("The specified user does not exist");break;case 18:t("Incorrect hour format");break;case 19:t("Incorrect minute format");break;case 20:t("Invalid event start date format");break;case 21:t("Invalid event end date format");break;case 22:t("No support for device location");break;case 23:t("Invalid Date Format");break;case 24:t("Event Successfully Created");break;case 25:t("Event End Date Is Before Start Date");break;case 26:t("Event End Time Is Before Start Time");break;case 27:t("Event Cannot Start Before Today");break;case 28:t("You are already attending this event");break;case 30:t("Location Have not been filled");break;case 31:t("Please Enter the Start Time First");break;case 32:t("Please Enter the Start Time");break;case 33:t("Please Enter the End Time");break;case 34:t("Guestlist contains invalid email")}},me=function(e){var t=document.getElementsByClassName("footer")[0];if(console.dir(t),e)for(var n=0;n<2;n++)t.children[1].children[n].classList.add("visible");else for(var n=0;n<2;n++)t.children[1].children[n].classList.remove("visible")},he=document.getElementById("reset-fields"),fe=function(){he.children[0].classList.add("rotate"),setTimeout(function(){he.children[0].classList.remove("rotate")},500);var e=d.querySelector("h2");if("NEW ACCOUNT"===e.innerText){var t=V.querySelectorAll("input");Array.prototype.map.call(t,function(e){e.value=""}),Le={}}else{var t=W.querySelectorAll("input");Array.prototype.map.call(t,function(e){e.value=""});var n=W.querySelectorAll("textarea");n.value="",$e={}}};he.addEventListener("click",function(){fe()});var ge=function(e){pe(!0);for(var t=0;t<6;t++){var e=V[t];if(""===e.value)return 0===t?V[t+1].scrollIntoView(!1):V[t-1].scrollIntoView(!0),void e.focus()}},pe=function(e){if(e){for(var t=0;t<5;t++){var n=V[t];if(""===n.value)return void me(!1)}me(!0)}else me(!1)},ye=function(e,t){t?""!==W[e].value&&($e[e]=W[e].value):""!==V[e].value&&(Le[e]=V[e].value)},Le={},Ee=function(){ye("employer",!1)},be=function(){ye("jobtitle",!1)},we=function(e){if(0===e.length)return!1;if(e.length<6)return ve(1),Y.select(),!1;var t=/[0-9]/;return t.test(e)?(t=/[a-z]/,t.test(e)?(t=/[A-Z]/,!!t.test(e)||(ve(4),Y.select(),!1)):(ve(3),Y.select(),!1)):(ve(2),Y.select(),!1)},ke=function(){var e=!1;""===V["retype-pass"].value?e=we(V.pass.value):V.pass.value!==V["retype-pass"].value?(V["retype-pass"].value="",V["retype-pass"].select(),ve(5)):(ye("pass",!1),e=!0),pe(e?!0:!1)},Ie=function(){g.show(),Object.keys(Le).map(function(e){Le[e].trim()});var e={};e.email=Le.email,e.password=Le.pass,t.createUser(e,function(n,i){n?ve(12):t.authWithPassword(e,function(e,n){if(e)console.log(e);else{var i=n.auth.uid;delete Le.email,delete Le.pass;var a={info:Le,events:["true"]};t.child("users").child(i).set(a,function(e,t){e?console.log("error"):(_(),Jt.active&&Jt.hideAll(),Ue(),fe(),Le={},g.hide(),ve(13))})}})})},Ae=function(){var e=V.name.value,t=/^[a-zA-Z\s]+$/;return 0!==e.length&&t.test(e)?(ye("name",!1),!0):0!==e.length&&(V.name.select(),void ve(10))},Ce=function(){var e=V.birthday.value,t=e.length;if(0===t)return void pe(!1);var n=function(e){var t=/^\d+$/;return!!t.test(e)},i=function(e){var t=e,n=t.substr(6,2);if(n>0&&n<=31){var i=t.substr(4,2);if(i>0&&i<=12){var a=t.substr(0,4),s=new Date,o=s.getFullYear()-100,c=s.getFullYear()-13;return a>=o&&a<=c?void 0:(V.birthday.select(),V.birthday.focus(),void ve(9))}return V.birthday.select(),void ve(8)}return V.birthday.select(),void ve(7)};if(8===t)n(e)?i(e):(ve(6),V.birthday.select());else{if(10!==t)return V.birthday.select(),ve(6),void pe(!1);var a=function(t){var n=t.split("-").join("");return e=n,n};n(a(e))?i(e):(ve(6),V.birthday.select())}pe(!0),ye("birthday",!1)},Be=function(){var e=V.email.value,t=e.length;if(0===t)return void pe(!1);if(t<=6)ve(11),V.email.select();else{var n=e.split("@");if(2===n.length){var i=n[1].split("."),t=i.length;2===t||3===t?(pe(!0),ye("email",!1)):(ve(11),V.email.select())}else ve(11),V.email.select()}},Te=function(){var e=d.querySelector("h2");return e.innerText="New Account",i.close(I),i.close(A),Jt.active?void Jt.showNewAccount():(d.classList.add("from-left","visible"),void setTimeout(function(){d.classList.add("from-left-to-middle"),b.classList.add("visibly"),i.show(T),i.show(x),setTimeout(function(){i.show(b)},200),setTimeout(function(){c.hide()},300)},100))},xe=document.getElementById("sign-up-button");xe.addEventListener("click",function(){Pe(),setTimeout(function(){Te()},300)});var Se=function(){i.hide(d),r.hide(),i.hide(Q),Q.removeAttribute("onclick","")},Ne=function(e){var t=e,n=document.createElement("li");return n.innerText=t["event-name"],n.addEventListener("click",function(){rt=t.id,location.hash="#id="+rt,Mt()}),n},Me=document.getElementById("user-events"),De=function(e){var n=e,i=dt[n];i?Me.appendChild(Ne(i)):t.child("events/unlisted").child(n).once("value",function(e){e.val()&&(dt[e.val().id]=e.val(),Me.appendChild(Ne(e.val())))})},Oe=!1,je=function(){F(),i.show(d),r.show(),i.show(Q),Q.addEventListener("click",Se),Oe||t.child("users").child(t.getAuth().uid).once("value",function(e){var t=e.val().events;r.getElement().querySelector("h2").innerText=e.val().info.name,t.map(function(e){"true"!==e&&De(e)}),Oe=!0})},Pe=function(){A.removeEventListener("click",Pe),A.classList.remove("opened"),i.hide(U)},qe=function(){F(),A.addEventListener("click",Pe),setTimeout(function(){i.open(A)},300),i.show(U),H.email.focus(),console.dir("sign in show")},He=function(e){var n=e.token;t.authWithCustomToken(n,function(e,t){e?console.log("Login Failed!",e):ve(14)})},Ue=function(){E.children[0].lastChild.data="My Account",E.removeEventListener("click",qe),E.addEventListener("click",je)},ze=function(){z.removeEventListener("click",ze),z.classList.remove("button");var e={};e.email=H.email.value,e.password=H.password.value,g.show(),t.authWithPassword(e,function(e,n){if(e){switch(e.code){case"INVALID_USER":ve(17);break;case"INVALID_PASSWORD":ve(15)}Ze(),g.hide()}else{g.hide(),Pe(),Ze(),Ue(),ve(14);var i=828e5;setInterval(function(){He(t.getAuth().token)},i)}})},Ye=function(){""!==H.email.value&&(H.password.value.length>=6?(z.classList.add("button"),z.addEventListener("click",ze)):(z.classList.remove("button"),z.removeEventListener("click",ze)))},Ve=function(){z.focus()},We=document.getElementById("password");We.addEventListener("keyup",Ye),We.addEventListener("blur",Ve);var Fe=function(){F(),t.unauth(),E.children[0].lastChild.data="Sign In",E.removeEventListener("click",je),E.addEventListener("click",qe),setTimeout(function(){ve(16)},300)};this.signOut=Fe;var _e=document.getElementById("dismiss-error");_e.addEventListener("click",function(){i.hide(L)});var Re,Ge,Ze=function(){for(var e=H.length,t=0;t<e;t++){var n=H[t];n.value=""}},$e={},Qe=function(){var e="event-name";ye(e,!0)},Je=function(){var e="event-type";ye(e,!0)},Ke=function(){var e="host";ye(e,!0)},Xe=function(e){var t;if(t=e?W["event-start-time"].value:W["event-end-time"].value,""!==t){var n=Date.parse(t),i=Date.now();if(e){if(!(n>i))return ve(27),W["event-start-time"].select(),void W["event-start-time"].focus();$e["event-start-time"]=n}else{var a=W["event-start-time"].value;if(""!==a){var s=Date.parse(a);if(!(n>s))return ve(25),W["event-end-time"].select(),void W["event-end-time"].focus();$e["event-end-time"]=n}else ve(31)}}else e?$e["event-start-time"]="":$e["event-end-time"]=""},et=function(){Xe(!0)},tt=function(){Xe()},nt=function(e){var t=e.split("@");if(2===t.length){var n=t[1].split("."),i=n.length;return 2===i||3===i}return!1},it=function(){var e=W.guestlist.value,t=e.split(",");t=t.map(function(e){var e=e.trim();return nt(e)?e:void ve(34)}),$e["guest-list-invitations"]=t},at=function(){var e=W.message.value;e&&($e["message-for-guests"]=e)},st=function(e,t){var n=e,i=t;$e["event-location-data"]={},$e["event-location-data"].name=i,$e["event-location-data"].address=n.formatted_address,$e["event-location-data"].lat=n.geometry.location.lat(),$e["event-location-data"].lng=n.geometry.location.lng()},ot=W["google-event-location"],ct=function(){var e=Re.getPlace();e.types.length>1?ot.value=e.name:ot.value=e.address_components[1].long_name+" "+e.address_components[0].long_name;var t=ot.value;st(e,t)},lt=function(){void 0!==Ge&&(google.maps.event.removeListener(Ge),Ge=void 0),Re=new google.maps.places.Autocomplete(ot),Ge=google.maps.event.addListener(Re,"place_changed",ct)};e.initAutocomplete=lt;var rt,dt,ut,vt=!0,mt=function(){var e=w.querySelector("#privacy-button"),t=e.children[0];t.classList.toggle("off"),vt=vt?!vt:!vt},ht=function(e){var t=dt[e]["event-location-data"].lat,n=dt[e]["event-location-data"].lng,i=y.getUserLoation().lat,a=y.getUserLoation().lng,s=t-i,o=n-a;return s<.1&&s>-.1&&o<.1&&o>-.1?S:s<.3&&s>-.3&&o<.3&&o>-.3?N:M},ft=function(e){var t=document.getElementById("info"),n=t.children[0],i=q.cloneNode(!0);i=Ct(i,e,!1,!0),i.children[0].setAttribute("style",""),i.addEventListener("click",function(){Jt.moveInfoToView(e);var n={};n.lat=dt[e]["event-location-data"].lat,n.lng=dt[e]["event-location-data"].lng,Zt.map.setCenter(n),t.classList.contains("expand")&&t.classList.remove("expand"),Array.prototype.forEach.call(t.children[0].children,function(e){e.classList.remove("selected")}),t.children[0].children[index].classList.add("selected")}),n.appendChild(i)},gt=function(e){var t,n=q.cloneNode(!0);Ct(n,e),Jt.active?ft(e):(t=ht(e),t.appendChild(n),kt())},pt=function(e,n){t.child("users").child(e).once("value",function(i){if(i.val()){var a=i.val().events;a.indexOf(n)===-1&&(a.push(n),t.child("users").child(e).update({events:a}))}})},yt=function(n){g.show();var i=$e["guest-list-invitations"],a=$e["message-for-guests"];if(delete $e["guest-list-invitations"],delete $e["message-for-guests"],!i)return ve(34),void g.hide();if($e.privacy)var s=t.child("events/unlisted").push($e,function(e,o){if(e)console.dir(e);else{var c=s.key();t.child("events/unlisted").child(c).update({id:c},function(e,t){e||g.hide()}),ve(24),$e=new Object,n.id=c,dt[c]=n,pt(t.getAuth().uid,c),gt(c),an(c,i,a)}});else var s=t.child("events/public").push($e,function(o,c){if(o)console.dir(o);else{var l=s.key();t.child("events/public").child(l).update({id:l},function(e,t){e?console.dir(e):g.hide()}),ve(24),$e=new Object,n.id=l,dt[l]=n,pt(t.getAuth().uid,l),gt(l);var r={};r.lat=dt[l]["event-location-data"].lat,r.lng=dt[l]["event-location-data"].lng;var d=new google.maps.Marker({position:r,map:Zt.map,animation:google.maps.Animation.DROP});d.addListener("click",function(){e.map.setCenter(r),Jt.moveInfoToView(key)}),an(l,i,a)}})},Lt=!1,Et=function(){if(!Lt){if(!$e["event-location-data"]||!$e["event-location-data"].lat)return ve(30),void g.hide();Lt=!0,_(),Jt.active&&Jt.hideAll(),$e.privacy=vt,$e["guest-count"]=1,$e.guests=[],$e.guests.push(t.getAuth().uid),Object.keys($e).map(function(e){"string"==typeof $e[e]&&($e[e]=$e[e].trim())}),yt($e),fe(),Lt=!1}},bt=function(e){for(var t=[W["event-name"],W["event-start-time"],W["event-end-time"],W["google-event-location"]],n=t.length,i=0;i<n;i++)if(""===t[i].value)return t[i].scrollIntoView(!0),void t[i].focus();wt()},wt=function(e){for(var t=[W["event-name"],W["event-start-time"],W["event-end-time"],W.guestlist,W["google-event-location"]],n=t.length,i=0;i<n;i++){var a=t[i];if(""===a.value)return void me(!1)}me(!0)},kt=function(){1===S.children.length?i.show(S.children[0]):i.hide(S.children[0]),1===N.children.length?i.show(N.children[0]):i.hide(N.children[0]),1===M.children.length?i.show(M.children[0]):i.hide(M.children[0])},It=function(e){for(var t=e,n=Object.keys(t),a=n.length,s=0;s<a;s++){var o=n[s],c=t[o];Tt(c)}var l=u.offsetWidth;l>=426&&(Zt.load(),Jt.load()),i.attachEventsToInputs(),kt(),g.hide()},At=function(e){if(null===t.getAuth())return!1;var n=t.getAuth().uid,i=dt[e].guests;return i.indexOf(n)!==-1},Ct=function(e,t,n,i){var a=dt[t],s=a["event-location-data"].lat,o=a["event-location-data"].lng,c=s-2e-4,l=o-9e-4,r=en(),d=r.height,u=r.width,v="https://maps.googleapis.com/maps/api/staticmap?center="+c+","+l+"&zoom=17&markers=color:red%7C"+s+","+o+"&size="+u+"x"+d+"&maptype=roadmap&key=AIzaSyBPSBuZde1QlCpGe7IhH674CWPSFSDTknk";e.children[0].style.backgroundImage="url("+v+")";var m=e.querySelector("h2");m.innerHTML=a["event-name"]+"<span></span>";var h=e.querySelector("ul"),f=new Date(a["event-start-time"]),g=new Date(a["event-end-time"]);if(h.children[0].innerText="Start: "+f.getHours()+":"+f.getMinutes()+" / "+f.getDate()+"."+f.getMonth()+"1."+f.getYear(),h.children[1].innerText="End: "+g.getHours()+":"+g.getMinutes()+" / "+g.getDate()+"."+g.getMonth()+"1."+g.getYear(),h.children[2].innerText="Place: "+a["event-location-data"].name,e.setAttribute("data-id",a.id),n){var p=e.querySelector(".head");p.innerHTML="<h2>"+a["event-name"]+"</h2>";var y=e.querySelector(".wrapper"),L=y.children[0].children[1];L.innerHTML="<span>"+a["event-location-data"].address+"</span>";var E=y.children[0].children[3];E.innerHTML="<span>"+a["guest-count"]+"</span>";var b=y.children[1].children[0].children[0];At(t)?b.innerText="Attending!":b.innerText="Attending?"}else if(!i){e.addEventListener("click",function(){K(e)});var w=e.querySelector(".share-icon");w.addEventListener("click",function(){an(t)})}return e},Bt=document.getElementsByClassName("event-item")[0],Tt=function(e){var t=e.id,n=e["event-location-data"].lat,i=e["event-location-data"].lng,a=(y.getUserLoation(),y.getUserLoation().lat),s=y.getUserLoation().lng,o=n-a,c=i-s,l=Bt.cloneNode(!0);Ct(l,t),o<.1&&o>-.1&&c<.1&&c>-.1?S.appendChild(l):o<.3&&o>-.3&&c<.3&&c>-.3?N.appendChild(l):M.appendChild(l)},xt=function(){var e=location.hash,t=e.substr(1).split("="),n=t.indexOf("id")+1;if(0!==n){var i=t[n];return rt=i,!0}return!1},St=function(){setTimeout(function(){J()},600),q.classList.add("visibly","visible")},Nt=document.getElementById("effect"),Mt=function(){i.show(Nt),setTimeout(function(){Ct(q,rt,!0),St()},300)},Dt=function(){var e,t=!1;e=setInterval(function(){void 0!==dt&&xt()&&!t&&(Mt(),t=!0),y.getUserLoation()&&void 0!==dt&&(clearInterval(e),It(dt))},500)},Ot=[],jt=function(){ut=Object.keys(dt),ut.map(function(e){Ot.push(dt[e]["event-name"])})},Pt=[],qt=document.getElementById("search-results"),Ht=document.getElementById("search-notification"),Ut=function(e){0!==e.length?(i.show(Ht),e.map(function(e){var t=ut[e];if(Pt.indexOf(t)===-1){var n=q.cloneNode(!0);Ct(n,t),qt.appendChild(n),Pt.push(t)}})):0!==Pt.length&&zt(!0)},zt=function(e){qt.innerHTML="",Pt=[],Ht.classList.remove("visible"),e||(ce.value="")},Yt=document.getElementById("clear-search");Yt.addEventListener("click",function(){zt()});var Vt=document.getElementById("search-input"),Wt=function(){var e=Vt.value.toLowerCase(),t=[];Ot.map(function(n,i){e===n.toLowerCase()&&t.push(i)}),Ut(t)};Vt.addEventListener("keyup",Wt);var Ft=function(){g.show(),Dt(),t.child("events/public").once("value",function(e){null!==e.val()?(dt=e.val(),jt()):dt={}})};Ft();var _t,Rt=function(){var e=document.getElementById("info");this.show=function(){e.classList.add("opened")}},Gt=(new Rt,function(){var e=this;this.map,this.load=function(){if(!this.map){this.map=new google.maps.Map(document.getElementById("map"),{center:{lat:y.getUserLoation().lat,lng:y.getUserLoation().lng},zoom:8});var t=Object.keys(dt);t.map(function(t){var n={};n.lat=dt[t]["event-location-data"].lat,n.lng=dt[t]["event-location-data"].lng;var i=new google.maps.Marker({position:n,map:e.map,animation:google.maps.Animation.DROP});i.addListener("click",function(){e.map.setCenter(n),Jt.moveInfoToView(t)})}),Array.prototype.map.call(dt,function(e){})}}}),Zt=new Gt,$t=function(){this.getEventLocation=function(e){var t={};return t.lat=dt[e]["event-location-data"].lat,t.lng=dt[e]["event-location-data"].lng,t}},Qt=(new $t,function(){var e,n=this,a=document.getElementById("overlay"),s=document.getElementById("side-container"),o=document.getElementById("info"),c=o.children[0],l="",r=o.children[1],v=o.children[2],m=o.children[3],s=document.getElementById("side-container"),h=document.getElementById("map");m.addEventListener("click",function(){o.classList.add("opened")}),r.addEventListener("click",function(){o.classList.remove("opened")}),v.addEventListener("click",function(){o.classList.toggle("expand"),o.classList.contains("expand")&&""!==c.style.transform?c.style.transform="":c.style.transform=l}),this.active=!1;var f=!1;this.load=function(){if(!f){f=!0,this.active=!0,e=Object.keys(dt),Array.prototype.map.call(e,function(e,t){var i=q.cloneNode(!0);i=Ct(i,e,!1,!0),i.children[0].setAttribute("style",""),i.addEventListener("click",function(){n.moveInfoToView(e);var i={};i.lat=dt[e]["event-location-data"].lat,i.lng=dt[e]["event-location-data"].lng,Zt.map.setCenter(i),o.classList.contains("expand")&&o.classList.remove("expand"),Array.prototype.forEach.call(o.children[0].children,function(e){e.classList.remove("selected")}),o.children[0].children[t].classList.add("selected")}),c.appendChild(i)});var t=document.getElementsByClassName("open-new-account-button")[0],i=document.getElementsByClassName("open-new-event-button")[0];t.addEventListener("click",n.openMyAccount),i.addEventListener("click",n.createNewEvent)}},this.unload=function(){u.appendChild(d),s.removeChild(a)},this.moveInfoToView=function(t){var n=e.indexOf(t);l="translateY(-"+100*n+"%)",c.style.transform=l};var g=d.getElementsByClassName("new-account-container")[0],p=d.getElementsByClassName("new-event-container")[0];this.hideAll=function(){i.hide(g),i.hide(p),i.hide(y),i.hide(L),i.hide(d),h.classList.remove("aside")},this.openSideContainer=function(){d.classList.add("visible"),h.classList.add("aside")},this.hideSideContainer=function(){d.classList.remove("visible"),h.classList.remove("aside"),n.hideAll()};var y=document.getElementById("my-account");this.showMyAccount=function(){i.show(y)},this.hideMyAccount=function(){i.hide(y)};var L=document.getElementById("create-account");this.hideCreateAccount=function(){i.hide(L)},this.showCreateAccount=function(){i.show(L)},this.showNewAccount=function(){d.classList.contains("visible")?n.hideSideContainer():(n.hideAll(),n.openSideContainer(),n.showCreateAccount(),i.show(g),n.hideMyAccount())},this.openMyAccount=function(){d.classList.contains("visible")?n.hideSideContainer():t.getAuth()?(n.hideAll(),n.openSideContainer(),n.showMyAccount(),je()):qe()},this.openNewAccount=function(){d.classList.contains("visible")?n.hideSideContainer():t.getAuth()?(n.hideAll(),n.openSideContainer(),n.showMyAccount(),je()):qe()},this.createNewEvent=function(){d.classList.contains("visible")?n.hideSideContainer():t.getAuth()?(n.hideAll(),n.openSideContainer(),n.hideMyAccount(),n.showCreateAccount(),se()):qe()}}),Jt=new Qt,u=document.getElementsByTagName("body")[0],Kt=function(){clearTimeout(_t),_t=setTimeout(function(){var e=u.offsetWidth;e>=426?(Zt.load(),Jt.load()):Xt()},500)},Xt=function(){var e=X;Array.prototype.forEach.call(e,function(e){var t=e.getAttribute("data-id");null!==t&&Ct(e,t)})},en=function(){q.style.display="flex",q.style.paddingBottom="0px";var e=q.children[0].offsetHeight,t=q.children[0].offsetWidth;return q.style.display="",q.style.paddingBottom="",{height:e,width:t}};window.onresize=Kt;var tn=function(){if(t.getAuth()){var e=q.querySelector(".guest-count").children[0],n=q.getAttribute("data-id");if(dt[n].guests.indexOf(t.getAuth().uid)===-1){var i=parseInt(e.innerText),a=i+1;if(e.innerText=a,dt[n]["guest-count"]=a,!dt[n].privacy){var s=dt[n].guests.push(t.getAuth().uid),o={};o["guest-count"]=s.length,o.guests=s,t.child("events/public").child(n).update(o,function(e){e?console.log(e):console.log("DONE!")})}}else ve(28)}else qe();console.dir(q.querySelector(".guest-count").children[0].innerText)},nn=document.getElementById("attend-event");nn.addEventListener("click",tn);var an=function(e,t,n){var i=e,a=dt[e]["event-name"],s=location.origin+"/#id="+i;if(t){var o=t.join(","),c=n;c?window.open("mailto:"+o+"?subject=Checkout This Event!&body="+c+", - Don't be shy and joing us at this '"+a+"' event! ---> "+s):window.open("mailto:"+o+"?subject=Checkout This Event!&body=Don't be shy and joing us at this '"+a+"' event! ---> "+s)}else window.open("mailto:xyz@abc.com?subject=Checkout This Event!&body=Hey, don't be shy and joing us at this '"+a+"' event! ---> "+s)},sn=function(){var e=q.getAttribute("data-id"),t=dt[e]["event-name"],n=location.href;window.open("mailto:xyz@abc.com?subject=Checkout This Event!&body=Hey, don't be shy and joing us at this '"+t+"' event! ---> "+n)},on=document.getElementById("email-guests");if(on.addEventListener("click",sn),t.getAuth()){E.children[0].lastChild.data="My Account",E.addEventListener("click",je),t.authWithCustomToken(t.getAuth().token,function(){});var cn=828e5;setInterval(function(){t.authWithCustomToken(t.getAuth().token,function(){})},cn)}else E.addEventListener("click",qe)},app=new App,initAutocomplete=app.initAutocomplete;