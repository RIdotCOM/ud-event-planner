"use strict";var App=function(){var e=this,t=new Firebase("https://event-creator.firebaseio.com/"),n=function(){var e=this,t={};this.registerElement=function(e){if(!t[e]){var n=document.getElementById(e),i={};return i.element=n,i.clickListeners=[],t[e]=i,i}},this.aClick=function(e,n){var i;t[e]||this.registerElement(e),i=t[e],console.log(i),i.clickListeners&&(i.clickListeners.map(function(e){i.element.removeEventListener("click",e)}),i.clickListeners=[]),i.element.addEventListener("click",n),i.clickListeners.push(n)},this.rClick=function(e,n){var i;i=t[e]?t[e]:registerElement(e),i.element.removeEventListener("click",n)},this.open=function(e){e.classList.add("opened")},this.close=function(e){e.classList.remove("opened")},this.show=function(e){e.classList.add("visible")},this.hide=function(e){e.classList.remove("visible")},this.attachEventsToInputs=function(){var t=[Ae,Ce,we,we,ke,be,Te],n=[Ke,$e,Qe,st,dt,rt,ht];console.log(W),Array.prototype.forEach.call(W,function(e,n){var i=document.getElementById(e.id);console.log(i);var o=t[n];console.log(o),i.addEventListener("blur",o)}),console.log(F),Array.prototype.forEach.call(F,function(e,t){if(7>t){var i=document.getElementById(e.id),o=n[t];i.addEventListener("blur",o)}}),e.aClick("privacy-button",Tt);var o=document.getElementsByClassName("logout-button")[0];o.addEventListener("click",function(){qe(),i.hide(u),l.hide(),sn.hideSideContainer()}),e.aClick("submit-button",Ie)}},i=new n,o=function(){var e=document.getElementById("fa");e.addEventListener("click",function(e){t.getAuth()?se():Re()}),this.expand=function(){e.classList.add("expand-animation")},this.shrink=function(){e.classList.remove("expand-animation")},this.raiseLevel=function(){e.style.zIndex=200},this.lowerLevel=function(){e.style.zIndex=""}},s=new o,r=function(){var e=document.getElementById("main");this.show=function(){e.classList.add("visible")},this.hide=function(){e.classList.remove("visible")}},a=new r,c=function(){var e=document.getElementById("my-account");this.hide=function(){e.classList.remove("visible")},this.show=function(){e.classList.add("visible")},this.getElement=function(){return e}},l=new c,u=document.getElementById("overlay"),d=document.getElementsByTagName("body")[0],h=window.getComputedStyle(d,null).getPropertyValue("font-size"),v=d.clientHeight,f=parseFloat(h),m=function(){var e=document.getElementById("spinner");this.show=function(){e.classList.add("show")},this.hide=function(){e.classList.remove("show")}},p=new m,g=function(){var e,t=function(t){return e={},e.lat=t.coords.latitude,e.lng=t.coords.longitude,e};this.saveUserLocation=function(e){return t(e)},this.handleLocationError=function(e){return console.log(e),!1},this.getUserLoation=function(){return e?e:!1},this.determineUserLoation=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(this.saveUserLocation,this.handleLocationError):alert("Geolocation is not supported by this browser")}},y=new g;y.getUserLoation()||y.determineUserLoation();var E=document.getElementById("error-container"),b=document.getElementById("sign-in"),T=document.getElementsByClassName("new-account-container")[0],L=document.getElementsByClassName("new-event-container")[0],w=(document.getElementById("event-overlay"),document.querySelector(".close-button"),document.getElementsByClassName("icon")[0]),I=document.getElementById("nav-overlay"),A=document.getElementById("faded-overlay"),k=document.getElementById("create-account"),C=document.getElementsByClassName("cancel-button"),S=document.getElementsByClassName("header")[0],N=document.getElementsByClassName("footer")[0],B=document.getElementById("nearby-list"),x=document.getElementById("closeby-list"),O=document.getElementById("faraway-list"),M=document.getElementsByClassName("nearby-button")[0],D=document.getElementsByClassName("closeby-button")[0],P=document.getElementsByClassName("faraway-button")[0],_=[B,x,O],R=document.getElementsByClassName("event-item")[0],Y=document.getElementById("sign-in-form"),z=document.getElementById("sign-in-overlay"),H=z.querySelector("h2"),U=document.getElementById("pass"),W=(document.getElementById("retype-pass"),document.getElementById("new-account-form")),F=document.getElementById("new-event-form");console.log(M),M.addEventListener("click",function(){_.forEach(function(e){e.classList.remove("lefty"),e.classList.remove("left")})}),D.addEventListener("click",function(){_.forEach(function(e){e.classList.add("left"),e.classList.remove("lefty")})}),P.addEventListener("click",function(){_.forEach(function(e){e.classList.add("lefty")})});var q=function(){I.classList.remove("opened"),A.classList.remove("opened")};A.addEventListener("click",function(){q()}),w.addEventListener("click",function(){I.classList.add("opened"),A.classList.add("opened")});for(var V=function(){i.aClick("submit-button",Ie),i.aClick("next-button",pe),k.classList.add("aside"),a.show(),sn.hideAll(),setTimeout(function(){k.classList.remove("aside"),u.classList.remove("visible"),T.classList.remove("visible","visibly"),L.classList.remove("visible","visibly"),S.classList.remove("visible"),N.classList.remove("visible"),u.classList.remove("from-left","visible","from-left-to-middle")},300)},j=C.length,X=0;j>X;X++)C[X].addEventListener("click",function(){V()});var G=function(){var e;this.set=function(t){e=t},this.get=function(){return e},this.pixelsToMove=0},Z=new G,K=document.getElementById("event-view-close");K.addEventListener("click",function(e){location.hash="";var t=document.getElementById("effect");if(t.classList.contains("visible"))K.classList.remove("visible"),t.classList.remove("visible"),R.classList.add("move-away"),setTimeout(function(){R.classList.remove("move-away","visibly","visible"),R.children[1].classList.remove("visible"),R.children[2].classList.remove("visibly","visible")},600);else{R.children[2].style.transition="all .1s ease-in-out",R.children[2].style.opacity="0",R.classList.add("hide");var n=function(){R.classList.remove("hide","seen"),R.children[1].classList.remove("visible"),R.children[2].classList.remove("visibly","visible"),K.classList.remove("visible"),R.style.transition="",R.style.transform="",R.style.display="",R.style["z-index"]="",R.children[2].style.transition="",R.children[2].style.opacity=""};setTimeout(function(){R.style.transition="all .3s ease-in-out",R.style.transform="translateY("+Z.pixelsToMove+"px)";var e=Z.get();e&&(e.style.transform="translateY(0px)"),setTimeout(function(){n()},300)},900)}});var $=function(){R.children[1].classList.add("visible"),R.children[2].classList.add("visible"),setTimeout(function(){R.children[2].classList.add("visibly")},1500),K.classList.add("visible")},Q=function(e){s.raiseLevel(),setTimeout(function(){s.lowerLevel()},300),Z.set(e);var t=e.getAttribute("data-id");location.hash="id="+t;var n=location.hash,i=n.substr(1).split("="),o=i.indexOf("id")+1,r=(i[o],e.getBoundingClientRect()),a=r.top;Z.pixelsToMove=a,Mt(R,t,!0),R.style.transform="translateY("+a+"px )",R.classList.add("seen"),R.style.display="flex",R.style["z-index"]="100",e.style.transition="transform .3s ease-in-out",e.style.transform="translateY(0px )",$();var c=-a;setTimeout(function(){R.style.transform="translateY(0px)",R.style.transition="all .3s ease-in-out"},0),e.style.transform="translateY("+c+"px)"},J=document.getElementsByClassName("event-item"),ee=new Hammer(B),te=new Hammer(x),ne=new Hammer(O),ie=new Hammer(I);ie.on("swipeleft",function(e){I.classList.remove("opened"),A.classList.remove("opened")}),ee.on("swipeleft",function(e){_.forEach(function(e){e.classList.add("left")})}),ee.on("swiperight",function(e){_.forEach(function(e){e.classList.remove("left")})}),te.on("swipeleft",function(e){_.forEach(function(e){e.classList.add("lefty")})}),te.on("swiperight",function(e){_.forEach(function(e){e.classList.remove("lefty"),e.classList.remove("left")})}),ne.on("swiperight",function(e){_.forEach(function(e){e.classList.remove("lefty")})});var oe=v-8*f;T.style.height=oe,T.style.minHeight=oe;var se=function(){ve(!1),s.expand(),k.querySelector("h2").innerText="Create Event",i.aClick("submit-button",St),i.aClick("next-button",Nt),i.show(u),L.classList.add("visibly"),i.show(S),i.show(N),setTimeout(function(){i.show(L),setTimeout(function(){s.shrink(),a.hide()},300)},200)},re=document.getElementById("search-form"),ae=document.getElementById("search-input"),ce=function(){ae.blur()};re.addEventListener("submit",ce);var le=document.getElementsByTagName("form"),ue=function(e){for(var t=0;t<e.length;t++)for(var n=e[t].length,t=0;n>t;t++){var i=e[t];void 0!==i&&i.addEventListener("click",function(e){e.target.select()})}};ue(le);var de=E.querySelector("p"),he=function(e){var t=function(e){de.innerText=e,i.show(E),setTimeout(function(){i.hide(E)},3e3)};switch(e){case 1:console.log("pass too short"),t("Password too short");break;case 2:console.log("there is no number in pass"),t("Password doesn't contain number");break;case 3:console.log("there is no lowercase letter in pass"),t("Password doesn't contain lowercase letter");break;case 4:console.log("there is no UpperCase Letter in pass"),t("Password doesn't contain uppercase letter");break;case 5:console.log("passwords do not match"),t("Passwords do not match");break;case 6:console.log("invalid birthday"),t("Invalid Birthday");break;case 7:console.log("day is wrong"),t("Incorrect Day format");break;case 8:console.log("month is wrong"),t("Incorrect Month format");break;case 9:console.log("year is wrong"),t("Incorrect Year format");break;case 10:console.log("Invalid Characters in Name"),t("Name containes invalid characters");break;case 11:console.log("Invalid Email"),t("Invalid Email Address");break;case 12:console.log("Email Already in Use"),t("Email Already in Use");break;case 13:console.log("Account Successfully Created"),t("Account Successfully Created");break;case 14:console.log("Sign In Successful"),t("Sign In Successful");break;case 15:console.log("Incorrect email or password"),t("Incorrect email or password");break;case 16:console.log("Logged out"),t("Logged out");break;case 17:console.log("The specified user does not exist"),t("The specified user does not exist");break;case 18:console.log("Incorrect hour format"),t("Incorrect hour format");break;case 19:console.log("Incorrect minute format"),t("Incorrect minute format");break;case 20:console.log("Incorrect minute format"),t("Invalid event start date format");break;case 21:console.log("Incorrect minute format"),t("Invalid event end date format");break;case 22:console.log("No support for device location"),t("No support for device location");break;case 23:console.log("Invalid Date Format"),t("Invalid Date Format");break;case 24:console.log("Event Successfully Created"),t("Event Successfully Created");break;case 25:console.log("Event End Date Is Before Start Date"),t("Event End Date Is Before Start Date");break;case 26:console.log("Event End Time Is Before Start Time"),t("Event End Time Is Before Start Time");break;case 27:console.log("Event Cannot Start Before Today"),t("Event Cannot Start Before Today");break;case 28:console.log("You are already attending this event"),t("You are already attending this event")}},ve=function(e){var t=document.getElementsByClassName("footer")[0];if(console.dir(t),e)for(var n=0;2>n;n++)t.children[1].children[n].classList.add("visible");else for(var n=0;2>n;n++)t.children[1].children[n].classList.remove("visible")},fe=document.getElementById("reset-fields"),me=function(){fe.children[0].classList.add("rotate"),setTimeout(function(){fe.children[0].classList.remove("rotate")},500);var e=u.querySelector("h2");if("NEW ACCOUNT"===e.innerText){for(var t=W.length,n=0;t>n;n++){var i=W.children[n];i.value=""}Ee={}}else{for(var t=F.length,o=0;t>o;o++){var i=F.children[o];i.value=""}Ze={}}};fe.addEventListener("click",function(){me()});var pe=function(e){ge(!0);for(var t=0;6>t;t++){var e=W[t];if(""===e.value)return 0===t?W[t+1].scrollIntoView(!1):W[t-1].scrollIntoView(!0),void e.focus()}},ge=function(e){if(e){for(var t=0;5>t;t++){var n=W[t];if(""===n.value)return void ve(!1)}ve(!0)}else ve(!1)},ye=function(e,t){t?""!==F[e].value&&(Ze[e]=F[e].value):""!==W[e].value&&(Ee[e]=W[e].value)},Ee={},be=function(){ye("employer",!1)},Te=function(){ye("jobtitle",!1)},Le=function(e){if(0===e.length)return!1;if(e.length<6)return he(1),U.select(),!1;var t=/[0-9]/;return t.test(e)?(t=/[a-z]/,t.test(e)?(t=/[A-Z]/,t.test(e)?!0:(console.log("there is no UpperCase Letter"),he(4),U.select(),!1)):(console.log("there is no lowercase letter"),he(3),U.select(),!1)):(console.log("there is no number"),he(2),U.select(),!1)},we=function(){var e=!1;""===W["retype-pass"].value?e=Le(W.pass.value):W.pass.value!==W["retype-pass"].value?(console.log("passwords do not match"),W["retype-pass"].value="",W["retype-pass"].select(),he(5)):(ye("pass",!1),e=!0),ge(e?!0:!1)},Ie=function(){p.show(),Object.keys(Ee).map(function(e){Ee[e].trim()});var e={};e.email=Ee.email,e.password=Ee.pass,t.createUser(e,function(n,i){n?(console.log(n),he(12)):(console.log(i),t.authWithPassword(e,function(e,n){if(e)console.log(e);else{console.log(n);var i=n.auth.uid;delete Ee.email,delete Ee.pass;var o={info:Ee,events:["true"]};t.child("users").child(i).set(o,function(e,t){e?console.log("error"):(V(),sn.active&&sn.hideAll(),ze(),me(),Ee={},p.hide(),he(13))})}}))})},Ae=function(){var e=W.name.value,t=/^[a-zA-Z\s]+$/;return 0!==e.length&&t.test(e)?(ye("name",!1),!0):0===e.length?!1:(W.name.select(),console.log("Invalid Characters"),he(10),void 0)},ke=function(){var e=W.birthday.value,t=e.length;if(0===t)return void ge(!1);var n=function(e){var t=/^\d+$/;return console.log(t.test(e)),t.test(e)?!0:!1},i=function(e){var t=e,n=t.substring(0,2);if(console.log(n),n>0&&31>=n){var i=t.substring(2,4);if(console.log(i),i>0&&12>=i){var o=t.substring(4,8);console.log(o);var s=new Date,r=s.getFullYear()-100,a=s.getFullYear()-13;return o>=r&&a>=o?(console.log("OK"),void console.log(t)):(console.log("year is wrong"),W.birthday.select(),void he(9))}return console.log("month is wrong"),W.birthday.select(),void he(8)}return console.log("day is wrong"),W.birthday.select(),void he(7)};if(8===t)n(e)?i(e):(he(6),W.birthday.select());else{if(10!==t)return console.log("its all wrong"),W.birthday.select(),he(6),void ge(!1);var o=function(t){var n=t.split("/").join("");return e=n,n};n(o(e))?i(e):(he(6),W.birthday.select())}ge(!0),ye("birthday",!1)},Ce=function(){var e=W.email.value,t=e.length;if(0===t)return void ge(!1);if(6>=t)he(11),W.email.select();else{var n=e.split("@");if(2===n.length){var i=n[1].split("."),t=i.length;2===t||3===t?(ge(!0),ye("email",!1)):(he(11),W.email.select())}else he(11),W.email.select()}},Se=function(){var e=u.querySelector("h2");return e.innerText="New Account",i.close(I),i.close(A),sn.active?void sn.showNewAccount():(u.classList.add("from-left","visible"),void setTimeout(function(){u.classList.add("from-left-to-middle"),T.classList.add("visibly"),i.show(S),i.show(N),setTimeout(function(){i.show(T)},200),setTimeout(function(){a.hide()},300)},100))},Ne=document.getElementById("sign-up-button");Ne.addEventListener("click",function(){_e(),setTimeout(function(){Se()},300)});var Be=function(){i.hide(u),l.hide(),i.hide(K),K.removeAttribute("onclick","")},xe=function(e){var t=e,n=document.createElement("li");return n.innerText=t["event-name"],n.addEventListener("click",function(){gt=t.id,location.hash="#id="+gt,zt()}),console.log(n),n},Oe=document.getElementById("user-events"),Me=function(e){var n=e,i=yt[n];i?Oe.appendChild(xe(i)):(console.log("GETTING UNLISTED EVENT"),t.child("events/unlisted").child(n).once("value",function(e){e.val()&&(console.log(e.val()),yt[e.val().id]=e.val(),Oe.appendChild(xe(e.val())))}))},De=!1,Pe=function(){q(),i.show(u),l.show(),i.show(K),K.addEventListener("click",Be),De||t.child("users").child(t.getAuth().uid).once("value",function(e){console.log(e.val());var t=e.val().events;l.getElement().querySelector("h2").innerText=e.val().info.name,t.map(function(e){"true"!==e&&(console.log(e),Me(e))}),De=!0})},_e=function(){A.removeEventListener("click",_e),A.classList.remove("opened"),i.hide(z),console.dir("sign in hide")},Re=function(){console.log("HELLO"),q(),A.addEventListener("click",_e),setTimeout(function(){i.open(A)},300),i.show(z),Y.email.focus(),console.dir("sign in show")},Ye=function(e){var n=e.token;t.authWithCustomToken(n,function(e,t){e?console.log("Login Failed!",e):(he(14),console.log("Authenticated successfully with payload:",t))})},ze=function(){b.children[0].lastChild.data="My Account",b.removeEventListener("click",Re),b.addEventListener("click",Pe)},He=function(){H.removeEventListener("click",He),H.classList.remove("button");var e={};e.email=Y.email.value,e.password=Y.password.value,p.show(),t.authWithPassword(e,function(e,n){if(e){switch(e.code){case"INVALID_USER":he(17);break;case"INVALID_PASSWORD":he(15)}Ge(),p.hide()}else{p.hide(),_e(),Ge(),ze(),he(14);var i=828e5;setInterval(function(){Ye(t.getAuth().token)},i)}})},Ue=function(){""!==Y.email.value&&(Y.password.value.length>=6?(H.classList.add("button"),H.addEventListener("click",He)):(H.classList.remove("button"),H.removeEventListener("click",He)))},We=function(){H.focus()},Fe=document.getElementById("password");Fe.addEventListener("keyup",Ue),Fe.addEventListener("blur",We);var qe=function(){q(),t.unauth(),b.children[0].lastChild.data="Sign In",b.removeEventListener("click",Pe),b.addEventListener("click",Re),setTimeout(function(){he(16)},300)};this.signOut=qe;var Ve=document.getElementById("dismiss-error");Ve.addEventListener("click",function(){i.hide(E)});var je,Xe,Ge=function(){for(var e=Y.length,t=0;e>t;t++){var n=Y[t];n.value=""}},Ze={},Ke=function(){console.log("PROCESS EVENT NAME");var e="event-name";ye(e,!0)},$e=function(){var e="event-type";ye(e,!0)},Qe=function(){var e="host";ye(e,!0)},Je=function(e){e?F["event-start-date"].select():F["event-end-date"].select()},et=function(e,t,n){var i=e,o=t,s=n,r=function(e){var t={date:e,day:parseInt(e.substr(0,2)),month:parseInt(e.substr(2,2)),year:parseInt(e.substr(4,2))};return t},a=new r(i),c=new r(o),l=function(){var e=parseInt(Ze["event-start-time"]),t=parseInt(Ze["event-end-time"]);return NaN!==e||NaN!==t?e>=t?!1:!0:void 0},u=function(e){s?e?F["event-start-time"].select():F["event-start-date"].select():e?F["event-end-time"].select():F["event-end-date"].select()},d=function(e,t){return t>=e?!0:!1},h=function(e,t){return e===t?!0:!1};if(d(a.year,c.year)){if(console.log("isGreaterOrEqual no. 1"),!h(a.year,c.year))return!0;if(console.log("isSame no. 1"),d(a.month,c.month)){if(console.log("isGreaterOrEqual no. 2"),!h(a.month,c.month))return!0;if(console.log("isSame no. 2"),d(a.day,c.day)){if(console.log("isGreaterOrEqual no. 3"),!h(a.day,c.day))return!0;if(console.log("isSame no. 2"),console.log(l()),l())return!0;he(26),u(!0)}else he(27),u(!1)}else he(27),u(!1)}else he(27),u(!1)},tt=function(e){var t=e;if(console.log(t),t.start){var n=new Date,i=n.getDate(),o=n.getMonth()+1,s=""+n.getFullYear(),r=parseInt(s.substr(2,4));10>i&&(i="0"+i),10>o&&(o="0"+o),n=i+""+o+r,et(n,t.date,!0)&&(Ze["event-start-date"]=t.date)}else{var a=Ze["event-start-date"];et(a,t.date,!1)&&(Ze["event-end-date"]=t.date)}},nt=function(e){var t=e,n=t.start;return t.day<0||t.day>31?(he(7),void Je(n)):t.month<0||t.month>12?(he(8),void Je(n)):t.year<16?(he(9),void Je(n)):void(tt(t)&&(n?Ze["event-start-date"]=t.date:Ze["event-end-date"]=t.date))},it=function(e){var t=e;return t.day=parseInt(t.date.substring(0,2)),t.month=parseInt(t.date.substring(2,4)),t.year=parseInt(t.date.substring(4,6)),t},ot=function(e){var t,n,i={};if(e?(t=F["event-start-date"].value,n=t.length,i.start=!0):(t=F["event-end-date"].value,n=t.length,i.start=!1),""!==t)if(6===n)i.date=t,nt(it(i));else{if(8!==n)return e?void he(20):void he(21);var o=t.split("/"),t=o.join("");6===t.length?(i.date=t,nt(it(i))):he(23)}},st=function(){ot(!0)},rt=function(){ot()},at=function(e,t){e?Ze["event-start-time"]=t:Ze["event-end-time"]=t},ct=function(e){e?F["event-start-time"].select():F["event-end-time"].select()},lt=function(e){var t,n,i=e,o=i.start;return t=parseInt(i.time.substring(0,2),10),n=parseInt(i.time.substring(2,4),10),0>t||t>24?(he(18),void ct(o)):0>n||n>59?(he(19),void ct(o)):void at(o,i.time)},ut=function(e){var t,n,i={};if(e?(t=F["event-start-time"].value,n=t.length,i.start=!0):(t=F["event-end-time"].value,n=t.length,i.start=!1),""!==t)if(4===n)i.time=t,lt(i);else{if(5!==n)return he(23),void(e?F["event-start-time"].select():F["event-end-time"].select());i.time=t.split(":").join("");var n=i.time.length;4===n&&lt(i)}},dt=function(){ut(!0)},ht=function(){ut()},vt=function(e,t){var n=e,i=t;Ze["event-location-data"]={},Ze["event-location-data"].name=i,Ze["event-location-data"].address=n.formatted_address,Ze["event-location-data"].lat=n.geometry.location.lat(),Ze["event-location-data"].lng=n.geometry.location.lng()},ft=F["google-event-location"],mt=function(){var e=je.getPlace();e.types.length>1?input.value=e.name:input.value=e.address_components[1].long_name+" "+e.address_components[0].long_name;var t=input.value;vt(e,t)},pt=function(){console.log(Xe),void 0!==Xe&&(google.maps.event.removeListener(Xe),Xe=void 0),je=new google.maps.places.Autocomplete(ft),Xe=google.maps.event.addListener(je,"place_changed",mt)};e.initAutocomplete=pt;var gt,yt,Et,bt=!0,Tt=function(){var e=L.querySelector("#privacy-button"),t=e.children[0];t.classList.toggle("off"),bt=bt?!bt:!bt},Lt=function(e){var t=yt[e]["event-location-data"].lat,n=yt[e]["event-location-data"].lng,i=y.getUserLoation().lat,o=y.getUserLoation().lng,s=t-i,r=n-o;return.1>s&&s>-.1&&.1>r&&r>-.1?(console.log("EVENT IS NEARBY"),B):.3>s&&s>-.3&&.3>r&&r>-.3?(console.log("EVENT IS CLOSEBY"),x):(console.log("EVENT IS FARAWAY"),O)},wt=function(e){var t=R.cloneNode(!0);Mt(t,e);var n=Lt(e);n.appendChild(t)},It=function(e,n){t.child("users").child(e).once("value",function(i){if(i.val()){var o=i.val().events;-1===o.indexOf(n)&&(o.push(n),t.child("users").child(e).update({events:o}))}})},At=function(e){if(p.show(),Ze.privacy){console.log("save to private events");var n=t.child("events/unlisted").push(Ze,function(i,o){if(i)console.dir(i);else{var s=n.key();t.child("events/unlisted").child(s).update({id:s},function(e,t){e?console.dir(e):p.hide()}),he(24),Ze=new Object,e.id=s,yt[s]=e,It(t.getAuth().uid,s),wt(s)}})}else{console.log("save to public events");var n=t.child("events/public").push(Ze,function(i,o){if(i)console.dir(i);else{var s=n.key();t.child("events/public").child(s).update({id:s},function(e,t){e?console.dir(e):p.hide()}),he(24),Ze=new Object,e.id=s,yt[s]=e,It(t.getAuth().uid,s),wt(s)}})}},kt=function(){var e=Ze["event-start-date"],t=Ze["event-end-date"];return console.log(et(e,t)),et(e,t)},Ct=!1,St=function(){console.log("SUBMITTING NEW EVENT!"),Ct||(Ct=!0,kt()?(V(),sn.active&&sn.hideAll(),Ze.privacy=bt,Ze["guest-count"]=1,Ze.guests=[],Ze.guests.push(t.getAuth().uid),Object.keys(Ze).map(function(e){"string"==typeof Ze[e]&&(Ze[e]=Ze[e].trim())}),At(Ze),me(),Ct=!1):Ct=!1)},Nt=function(e){console.log("FOCUS NEXT ELEMENT");for(var t=[F["event-name"],F["event-start-date"],F["event-start-time"],F["event-end-date"],F["event-end-time"],F["google-event-location"]],n=t.length,i=0;n>i;i++)if(""===t[i].value)return t[i].scrollIntoView(!0),void t[i].focus();Bt()},Bt=function(e){console.log("CHECK IF NEW EVENT READY FOR SUBMIT");for(var t=[F["event-name"],F["event-start-date"],F["event-start-time"],F["event-end-date"],F["event-end-time"],F["google-event-location"]],n=t.length,i=0;n>i;i++){var o=t[i];if(""===o.value)return void ve(!1)}ve(!0)},xt=function(e){for(var t=e,n=Object.keys(t),o=n.length,s=0;o>s;s++){var r=n[s],a=t[r];Pt(a)}var c=d.offsetWidth;c>=426&&(console.log("TIME TO LOAD GOOGLE MAP!"),tn.load(),sn.load()),i.attachEventsToInputs(),p.hide()},Ot=function(e){if(null===t.getAuth())return!1;var n=t.getAuth().uid,i=yt[e].guests;return-1!==i.indexOf(n)?!0:!1},Mt=function(e,t,n,i){var o=yt[t],s=o["event-location-data"].lat,r=o["event-location-data"].lng,a=s-2e-4,c=r-9e-4,l=cn(),u=l.height,d=l.width,h="https://maps.googleapis.com/maps/api/staticmap?center="+a+","+c+"&zoom=17&markers=color:red%7C"+s+","+r+"&size="+d+"x"+u+"&maptype=roadmap&key=AIzaSyBPSBuZde1QlCpGe7IhH674CWPSFSDTknk";e.children[0].style.backgroundImage="url("+h+")";var v=e.querySelector("h2");v.innerHTML=o["event-name"]+"<span></span>";var f=e.querySelector("ul"),m=o["event-start-time"];m=m.substring(0,2)+":"+m.substring(2,4);var p=o["event-end-time"];p=p.substring(0,2)+":"+p.substring(2,4);var g=o["event-start-date"];g=g.substring(0,2)+"."+g.substring(2,4)+"."+g.substring(4,6);var y=o["event-start-date"];if(y=g.substring(0,2)+"."+y.substring(2,4)+"."+y.substring(4,6),f.children[0].innerText="Start: "+m+" / "+g,f.children[1].innerText="End: "+p+" / "+y,f.children[2].innerText="Place: "+o["event-location-data"].name,e.setAttribute("data-id",o.id),n){var E=e.querySelector(".head");E.innerHTML="<h2>"+o["event-name"]+"</h2>";var b=e.querySelector(".wrapper"),T=b.children[0].children[1];T.innerHTML="<span>"+o["event-location-data"].address+"</span>";var L=b.children[0].children[3];L.innerHTML="<span>"+o["guest-count"]+"</span>";var w=b.children[1].children[0].children[0];Ot(t)?w.innerText="Attending!":w.innerText="Attending?"}else if(!i){e.addEventListener("click",function(){Q(e)});var I=e.querySelector(".share-icon");I.addEventListener("click",function(){dn(t)})}return e},Dt=document.getElementsByClassName("event-item")[0],Pt=function(e){var t=e.id,n=e["event-location-data"].lat,i=e["event-location-data"].lng,o=(y.getUserLoation(),y.getUserLoation().lat),s=y.getUserLoation().lng,r=n-o,a=i-s,c=Dt.cloneNode(!0);Mt(c,t),.1>r&&r>-.1&&.1>a&&a>-.1?(console.log("EVENT IS NEARBY"),B.appendChild(c)):.3>r&&r>-.3&&.3>a&&a>-.3?(console.log("EVENT IS CLOSEBY"),x.appendChild(c)):(console.log("EVENT IS FARAWAY"),O.appendChild(c))},_t=function(){var e=location.hash,t=e.substr(1).split("="),n=t.indexOf("id")+1;if(0!==n){var i=t[n];return gt=i,!0}return!1},Rt=function(){setTimeout(function(){$()},600),R.classList.add("visibly","visible")},Yt=document.getElementById("effect"),zt=function(){i.show(Yt),setTimeout(function(){Mt(R,gt,!0),Rt()},300)},Ht=function(){var e,t=!1;e=setInterval(function(){console.log("RUNNING INTERVAL"),void 0!==yt&&_t()&&!t&&(zt(),t=!0),y.getUserLoation()&&void 0!==yt&&(clearInterval(e),xt(yt))},500)},Ut=[],Wt=function(){Et=Object.keys(yt),Et.map(function(e){Ut.push(yt[e]["event-name"])})},Ft=[],qt=document.getElementById("search-results"),Vt=document.getElementById("search-notification"),jt=function(e){0!==e.length?(i.show(Vt),e.map(function(e){var t=Et[e];if(-1===Ft.indexOf(t)){var n=R.cloneNode(!0);Mt(n,t),qt.appendChild(n),Ft.push(t)}})):0!==Ft.length&&Xt(!0)},Xt=function(e){qt.innerHTML="",Ft=[],Vt.classList.remove("visible"),e||(ae.value="")},Gt=document.getElementById("clear-search");Gt.addEventListener("click",function(){Xt()});var Zt=document.getElementById("search-input"),Kt=function(){var e=Zt.value.toLowerCase(),t=[];Ut.map(function(n,i){e===n.toLowerCase()&&t.push(i)}),jt(t)};Zt.addEventListener("keyup",Kt);var $t=function(){p.show(),Ht(),t.child("events/public").once("value",function(e){null!==e.val()?(yt=e.val(),Wt()):yt={}})};$t();var Qt,Jt=function(){var e=document.getElementById("info");this.show=function(){e.classList.add("opened")}},en=(new Jt,function(){var e=this;this.map,this.load=function(){if(!this.map){console.log("LOADING GOOGLE MAP!"),this.map=new google.maps.Map(document.getElementById("map"),{center:{lat:y.getUserLoation().lat,lng:y.getUserLoation().lng},zoom:8}),console.log(yt);var t=Object.keys(yt);t.map(function(t){var n={};n.lat=yt[t]["event-location-data"].lat,n.lng=yt[t]["event-location-data"].lng;var i=new google.maps.Marker({position:n,map:e.map,animation:google.maps.Animation.DROP});i.addListener("click",function(){e.map.setCenter(n),sn.moveInfoToView(t),console.log(t)})}),Array.prototype.map.call(yt,function(e){console.log(e)})}}}),tn=new en,nn=function(){this.getEventLocation=function(e){var t={};return t.lat=yt[e]["event-location-data"].lat,t.lng=yt[e]["event-location-data"].lng,t}},on=(new nn,function(){var e,n=this,o=document.getElementById("overlay"),s=document.getElementById("side-container"),r=document.getElementById("info"),a=r.children[0],c="",l=r.children[1],h=r.children[2],v=r.children[3],f=[],s=document.getElementById("side-container"),m=document.getElementById("map");v.addEventListener("click",function(){r.classList.add("opened")}),l.addEventListener("click",function(){r.classList.remove("opened")}),h.addEventListener("click",function(){r.classList.toggle("expand"),r.classList.contains("expand")&&""!==a.style.transform?a.style.transform="":a.style.transform=c}),this.active=!1;var p=!1;this.load=function(){if(!p){p=!0,this.active=!0,e=Object.keys(yt),Array.prototype.map.call(e,function(e,t){var i=R.cloneNode(!0);i=Mt(i,e,!1,!0),i.children[0].setAttribute("style",""),i.addEventListener("click",function(){n.moveInfoToView(e);var i={};i.lat=yt[e]["event-location-data"].lat,i.lng=yt[e]["event-location-data"].lng,tn.map.setCenter(i),r.classList.contains("expand")&&r.classList.remove("expand"),console.log(r),console.log(r.children),console.log(r.children[0].children[t]),Array.prototype.forEach.call(r.children[0].children,function(e){console.log(e),e.classList.remove("selected")}),r.children[0].children[t].classList.add("selected")}),a.appendChild(i),f.push(i)});var t=document.getElementsByClassName("open-new-account-button")[0],i=document.getElementsByClassName("open-new-event-button")[0];t.addEventListener("click",n.openMyAccount),i.addEventListener("click",n.createNewEvent)}},this.unload=function(){console.log("please remove and reattach overlay elements to dom, thank you"),d.appendChild(u),s.removeChild(o)},this.moveInfoToView=function(t){var n=e.indexOf(t);console.log(n),c="translateY(-"+100*n+"%)",a.style.transform=c,console.log(a),console.log(a.style),console.log(a.style.transform)};var g=u.getElementsByClassName("new-account-container")[0],y=u.getElementsByClassName("new-event-container")[0];this.hideAll=function(){i.hide(g),i.hide(y),i.hide(E),i.hide(b),i.hide(u),m.classList.remove("aside")},this.openSideContainer=function(){u.classList.add("visible"),m.classList.add("aside")},this.hideSideContainer=function(){u.classList.remove("visible"),m.classList.remove("aside"),n.hideAll()};var E=document.getElementById("my-account");this.showMyAccount=function(){i.show(E)},this.hideMyAccount=function(){i.hide(E)};var b=document.getElementById("create-account");this.hideCreateAccount=function(){i.hide(b)},this.showCreateAccount=function(){i.show(b)},this.showNewAccount=function(){u.classList.contains("visible")?n.hideSideContainer():(n.hideAll(),n.openSideContainer(),n.showCreateAccount(),i.show(g),n.hideMyAccount())},this.openMyAccount=function(){u.classList.contains("visible")?n.hideSideContainer():t.getAuth()?(n.hideAll(),n.openSideContainer(),n.showMyAccount(),Pe()):Re()},this.openNewAccount=function(){u.classList.contains("visible")?n.hideSideContainer():t.getAuth()?(n.hideAll(),n.openSideContainer(),n.showMyAccount(),Pe()):Re()},this.createNewEvent=function(){u.classList.contains("visible")?n.hideSideContainer():t.getAuth()?(n.hideAll(),n.openSideContainer(),n.hideMyAccount(),n.showCreateAccount(),se()):Re()}}),sn=new on,d=document.getElementsByTagName("body")[0],rn=function(){clearTimeout(Qt),Qt=setTimeout(function(){var e=d.offsetWidth;e>=426?(console.log("TIME TO LOAD GOOGLE MAP!"),tn.load(),sn.load()):an()},500)},an=function(){var e=J;Array.prototype.forEach.call(e,function(e){var t=e.getAttribute("data-id");null!==t&&Mt(e,t)})},cn=function(){R.style.display="flex",R.style.paddingBottom="0px";var e=R.children[0].offsetHeight,t=R.children[0].offsetWidth;return R.style.display="",R.style.paddingBottom="",{height:e,width:t}};window.onresize=rn;var ln=function(){if(t.getAuth()){var e=R.querySelector(".guest-count").children[0],n=R.getAttribute("data-id");if(-1===yt[n].guests.indexOf(t.getAuth().uid)){
var i=parseInt(e.innerText),o=i+1;if(e.innerText=o,yt[n]["guest-count"]=o,!yt[n].privacy){var s=yt[n].guests.push(t.getAuth().uid),r={};r["guest-count"]=s.length,r.guests=s,t.child("events/public").child(n).update(r,function(e){e?(console.log("error"),console.log(e)):console.log("DONE!")})}}else he(28)}else Re();console.dir(R.querySelector(".guest-count").children[0].innerText)},un=document.getElementById("attend-event");un.addEventListener("click",ln);var dn=function(e){var t=e,n=yt[e]["event-name"],i=location.href+"#id="+t;window.open("mailto:xyz@abc.com?subject=Checkout This Event!&body=Hey, don't be shy and joing us at this '"+n+"' event! ---> "+i)},hn=function(){var e=R.getAttribute("data-id"),t=yt[e]["event-name"],n=location.href;window.open("mailto:xyz@abc.com?subject=Checkout This Event!&body=Hey, don't be shy and joing us at this '"+t+"' event! ---> "+n)},vn=document.getElementById("email-guests");if(vn.addEventListener("click",hn),t.getAuth()){b.children[0].lastChild.data="My Account",b.addEventListener("click",Pe),t.authWithCustomToken(t.getAuth().token,function(e,t){e||console.log("AUTHENTICATED")});var fn=828e5;setInterval(function(){t.authWithCustomToken(t.getAuth().token,function(e,t){e||console.log("horay")})},fn)}else b.addEventListener("click",Re)},app=new App,initAutocomplete=app.initAutocomplete;!function(e,t,n,i){function o(e,t,n){return setTimeout(l(e,n),t)}function s(e,t,n){return Array.isArray(e)?(r(e,n[t],n),!0):!1}function r(e,t,n){var o;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==i)for(o=0;o<e.length;)t.call(n,e[o],o,e),o++;else for(o in e)e.hasOwnProperty(o)&&t.call(n,e[o],o,e)}function a(t,n,i){var o="DEPRECATED METHOD: "+n+"\n"+i+" AT \n";return function(){var n=new Error("get-stack-trace"),i=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=e.console&&(e.console.warn||e.console.log);return s&&s.call(e.console,o,i),t.apply(this,arguments)}}function c(e,t,n){var i,o=t.prototype;i=e.prototype=Object.create(o),i.constructor=e,i._super=o,n&&ae(i,n)}function l(e,t){return function(){return e.apply(t,arguments)}}function u(e,t){return typeof e==ue?e.apply(t?t[0]||i:i,t):e}function d(e,t){return e===i?t:e}function h(e,t,n){r(p(t),function(t){e.addEventListener(t,n,!1)})}function v(e,t,n){r(p(t),function(t){e.removeEventListener(t,n,!1)})}function f(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function m(e,t){return e.indexOf(t)>-1}function p(e){return e.trim().split(/\s+/g)}function g(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function y(e){return Array.prototype.slice.call(e,0)}function E(e,t,n){for(var i=[],o=[],s=0;s<e.length;){var r=t?e[s][t]:e[s];g(o,r)<0&&i.push(e[s]),o[s]=r,s++}return n&&(i=t?i.sort(function(e,n){return e[t]>n[t]}):i.sort()),i}function b(e,t){for(var n,o,s=t[0].toUpperCase()+t.slice(1),r=0;r<ce.length;){if(n=ce[r],o=n?n+s:t,o in e)return o;r++}return i}function T(){return pe++}function L(t){var n=t.ownerDocument||t;return n.defaultView||n.parentWindow||e}function w(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){u(e.options.enable,[e])&&n.handler(t)},this.init()}function I(e){var t,n=e.options.inputClass;return new(t=n?n:Ee?Y:be?U:ye?F:R)(e,A)}function A(e,t,n){var i=n.pointers.length,o=n.changedPointers.length,s=t&ke&&i-o===0,r=t&(Se|Ne)&&i-o===0;n.isFirst=!!s,n.isFinal=!!r,s&&(e.session={}),n.eventType=t,k(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function k(e,t){var n=e.session,i=t.pointers,o=i.length;n.firstInput||(n.firstInput=N(t)),o>1&&!n.firstMultiple?n.firstMultiple=N(t):1===o&&(n.firstMultiple=!1);var s=n.firstInput,r=n.firstMultiple,a=r?r.center:s.center,c=t.center=B(i);t.timeStamp=ve(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=D(a,c),t.distance=M(a,c),C(n,t),t.offsetDirection=O(t.deltaX,t.deltaY);var l=x(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=l.x,t.overallVelocityY=l.y,t.overallVelocity=he(l.x)>he(l.y)?l.x:l.y,t.scale=r?_(r.pointers,i):1,t.rotation=r?P(r.pointers,i):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,S(n,t);var u=e.element;f(t.srcEvent.target,u)&&(u=t.srcEvent.target),t.target=u}function C(e,t){var n=t.center,i=e.offsetDelta||{},o=e.prevDelta||{},s=e.prevInput||{};(t.eventType===ke||s.eventType===Se)&&(o=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},i=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=o.x+(n.x-i.x),t.deltaY=o.y+(n.y-i.y)}function S(e,t){var n,o,s,r,a=e.lastInterval||t,c=t.timeStamp-a.timeStamp;if(t.eventType!=Ne&&(c>Ae||a.velocity===i)){var l=t.deltaX-a.deltaX,u=t.deltaY-a.deltaY,d=x(c,l,u);o=d.x,s=d.y,n=he(d.x)>he(d.y)?d.x:d.y,r=O(l,u),e.lastInterval=t}else n=a.velocity,o=a.velocityX,s=a.velocityY,r=a.direction;t.velocity=n,t.velocityX=o,t.velocityY=s,t.direction=r}function N(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:de(e.pointers[n].clientX),clientY:de(e.pointers[n].clientY)},n++;return{timeStamp:ve(),pointers:t,center:B(t),deltaX:e.deltaX,deltaY:e.deltaY}}function B(e){var t=e.length;if(1===t)return{x:de(e[0].clientX),y:de(e[0].clientY)};for(var n=0,i=0,o=0;t>o;)n+=e[o].clientX,i+=e[o].clientY,o++;return{x:de(n/t),y:de(i/t)}}function x(e,t,n){return{x:t/e||0,y:n/e||0}}function O(e,t){return e===t?Be:he(e)>=he(t)?0>e?xe:Oe:0>t?Me:De}function M(e,t,n){n||(n=Ye);var i=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return Math.sqrt(i*i+o*o)}function D(e,t,n){n||(n=Ye);var i=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return 180*Math.atan2(o,i)/Math.PI}function P(e,t){return D(t[1],t[0],ze)+D(e[1],e[0],ze)}function _(e,t){return M(t[0],t[1],ze)/M(e[0],e[1],ze)}function R(){this.evEl=Ue,this.evWin=We,this.allow=!0,this.pressed=!1,w.apply(this,arguments)}function Y(){this.evEl=Ve,this.evWin=je,w.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function z(){this.evTarget=Ge,this.evWin=Ze,this.started=!1,w.apply(this,arguments)}function H(e,t){var n=y(e.touches),i=y(e.changedTouches);return t&(Se|Ne)&&(n=E(n.concat(i),"identifier",!0)),[n,i]}function U(){this.evTarget=$e,this.targetIds={},w.apply(this,arguments)}function W(e,t){var n=y(e.touches),i=this.targetIds;if(t&(ke|Ce)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var o,s,r=y(e.changedTouches),a=[],c=this.target;if(s=n.filter(function(e){return f(e.target,c)}),t===ke)for(o=0;o<s.length;)i[s[o].identifier]=!0,o++;for(o=0;o<r.length;)i[r[o].identifier]&&a.push(r[o]),t&(Se|Ne)&&delete i[r[o].identifier],o++;return a.length?[E(s.concat(a),"identifier",!0),a]:void 0}function F(){w.apply(this,arguments);var e=l(this.handler,this);this.touch=new U(this.manager,e),this.mouse=new R(this.manager,e)}function q(e,t){this.manager=e,this.set(t)}function V(e){if(m(e,it))return it;var t=m(e,ot),n=m(e,st);return t&&n?it:t||n?t?ot:st:m(e,nt)?nt:tt}function j(e){this.options=ae({},this.defaults,e||{}),this.id=T(),this.manager=null,this.options.enable=d(this.options.enable,!0),this.state=rt,this.simultaneous={},this.requireFail=[]}function X(e){return e&dt?"cancel":e&lt?"end":e&ct?"move":e&at?"start":""}function G(e){return e==De?"down":e==Me?"up":e==xe?"left":e==Oe?"right":""}function Z(e,t){var n=t.manager;return n?n.get(e):e}function K(){j.apply(this,arguments)}function $(){K.apply(this,arguments),this.pX=null,this.pY=null}function Q(){K.apply(this,arguments)}function J(){j.apply(this,arguments),this._timer=null,this._input=null}function ee(){K.apply(this,arguments)}function te(){K.apply(this,arguments)}function ne(){j.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ie(e,t){return t=t||{},t.recognizers=d(t.recognizers,ie.defaults.preset),new oe(e,t)}function oe(e,t){this.options=ae({},ie.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.element=e,this.input=I(this),this.touchAction=new q(this,this.options.touchAction),se(this,!0),r(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function se(e,t){var n=e.element;n.style&&r(e.options.cssProps,function(e,i){n.style[b(n.style,i)]=t?e:""})}function re(e,n){var i=t.createEvent("Event");i.initEvent(e,!0,!0),i.gesture=n,n.target.dispatchEvent(i)}var ae,ce=["","webkit","Moz","MS","ms","o"],le=t.createElement("div"),ue="function",de=Math.round,he=Math.abs,ve=Date.now;ae="function"!=typeof Object.assign?function(e){if(e===i||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(o!==i&&null!==o)for(var s in o)o.hasOwnProperty(s)&&(t[s]=o[s])}return t}:Object.assign;var fe=a(function(e,t,n){for(var o=Object.keys(t),s=0;s<o.length;)(!n||n&&e[o[s]]===i)&&(e[o[s]]=t[o[s]]),s++;return e},"extend","Use `assign`."),me=a(function(e,t){return fe(e,t,!0)},"merge","Use `assign`."),pe=1,ge=/mobile|tablet|ip(ad|hone|od)|android/i,ye="ontouchstart"in e,Ee=b(e,"PointerEvent")!==i,be=ye&&ge.test(navigator.userAgent),Te="touch",Le="pen",we="mouse",Ie="kinect",Ae=25,ke=1,Ce=2,Se=4,Ne=8,Be=1,xe=2,Oe=4,Me=8,De=16,Pe=xe|Oe,_e=Me|De,Re=Pe|_e,Ye=["x","y"],ze=["clientX","clientY"];w.prototype={handler:function(){},init:function(){this.evEl&&h(this.element,this.evEl,this.domHandler),this.evTarget&&h(this.target,this.evTarget,this.domHandler),this.evWin&&h(L(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&v(this.element,this.evEl,this.domHandler),this.evTarget&&v(this.target,this.evTarget,this.domHandler),this.evWin&&v(L(this.element),this.evWin,this.domHandler)}};var He={mousedown:ke,mousemove:Ce,mouseup:Se},Ue="mousedown",We="mousemove mouseup";c(R,w,{handler:function(e){var t=He[e.type];t&ke&&0===e.button&&(this.pressed=!0),t&Ce&&1!==e.which&&(t=Se),this.pressed&&this.allow&&(t&Se&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:we,srcEvent:e}))}});var Fe={pointerdown:ke,pointermove:Ce,pointerup:Se,pointercancel:Ne,pointerout:Ne},qe={2:Te,3:Le,4:we,5:Ie},Ve="pointerdown",je="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Ve="MSPointerDown",je="MSPointerMove MSPointerUp MSPointerCancel"),c(Y,w,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),o=Fe[i],s=qe[e.pointerType]||e.pointerType,r=s==Te,a=g(t,e.pointerId,"pointerId");o&ke&&(0===e.button||r)?0>a&&(t.push(e),a=t.length-1):o&(Se|Ne)&&(n=!0),0>a||(t[a]=e,this.callback(this.manager,o,{pointers:t,changedPointers:[e],pointerType:s,srcEvent:e}),n&&t.splice(a,1))}});var Xe={touchstart:ke,touchmove:Ce,touchend:Se,touchcancel:Ne},Ge="touchstart",Ze="touchstart touchmove touchend touchcancel";c(z,w,{handler:function(e){var t=Xe[e.type];if(t===ke&&(this.started=!0),this.started){var n=H.call(this,e,t);t&(Se|Ne)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:Te,srcEvent:e})}}});var Ke={touchstart:ke,touchmove:Ce,touchend:Se,touchcancel:Ne},$e="touchstart touchmove touchend touchcancel";c(U,w,{handler:function(e){var t=Ke[e.type],n=W.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:Te,srcEvent:e})}}),c(F,w,{handler:function(e,t,n){var i=n.pointerType==Te,o=n.pointerType==we;if(i)this.mouse.allow=!1;else if(o&&!this.mouse.allow)return;t&(Se|Ne)&&(this.mouse.allow=!0),this.callback(e,t,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Qe=b(le.style,"touchAction"),Je=Qe!==i,et="compute",tt="auto",nt="manipulation",it="none",ot="pan-x",st="pan-y";q.prototype={set:function(e){e==et&&(e=this.compute()),Je&&this.manager.element.style&&(this.manager.element.style[Qe]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return r(this.manager.recognizers,function(t){u(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),V(e.join(" "))},preventDefaults:function(e){if(!Je){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)return void t.preventDefault();var i=this.actions,o=m(i,it),s=m(i,st),r=m(i,ot);if(o){var a=1===e.pointers.length,c=e.distance<2,l=e.deltaTime<250;if(a&&c&&l)return}if(!r||!s)return o||s&&n&Pe||r&&n&_e?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var rt=1,at=2,ct=4,lt=8,ut=lt,dt=16,ht=32;j.prototype={defaults:{},set:function(e){return ae(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(s(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=Z(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return s(e,"dropRecognizeWith",this)?this:(e=Z(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(s(e,"requireFailure",this))return this;var t=this.requireFail;return e=Z(e,this),-1===g(t,e)&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(s(e,"dropRequireFailure",this))return this;e=Z(e,this);var t=g(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){function t(t){n.manager.emit(t,e)}var n=this,i=this.state;lt>i&&t(n.options.event+X(i)),t(n.options.event),e.additionalEvent&&t(e.additionalEvent),i>=lt&&t(n.options.event+X(i))},tryEmit:function(e){return this.canEmit()?this.emit(e):void(this.state=ht)},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(ht|rt)))return!1;e++}return!0},recognize:function(e){var t=ae({},e);return u(this.options.enable,[this,t])?(this.state&(ut|dt|ht)&&(this.state=rt),this.state=this.process(t),void(this.state&(at|ct|lt|dt)&&this.tryEmit(t))):(this.reset(),void(this.state=ht))},process:function(e){},getTouchAction:function(){},reset:function(){}},c(K,j,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=t&(at|ct),o=this.attrTest(e);return i&&(n&Ne||!o)?t|dt:i||o?n&Se?t|lt:t&at?t|ct:at:ht}}),c($,K,{defaults:{event:"pan",threshold:10,pointers:1,direction:Re},getTouchAction:function(){var e=this.options.direction,t=[];return e&Pe&&t.push(st),e&_e&&t.push(ot),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,o=e.direction,s=e.deltaX,r=e.deltaY;return o&t.direction||(t.direction&Pe?(o=0===s?Be:0>s?xe:Oe,n=s!=this.pX,i=Math.abs(e.deltaX)):(o=0===r?Be:0>r?Me:De,n=r!=this.pY,i=Math.abs(e.deltaY))),e.direction=o,n&&i>t.threshold&&o&t.direction},attrTest:function(e){return K.prototype.attrTest.call(this,e)&&(this.state&at||!(this.state&at)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=G(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),c(Q,K,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[it]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&at)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),c(J,j,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[tt]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,s=e.deltaTime>t.time;if(this._input=e,!i||!n||e.eventType&(Se|Ne)&&!s)this.reset();else if(e.eventType&ke)this.reset(),this._timer=o(function(){this.state=ut,this.tryEmit()},t.time,this);else if(e.eventType&Se)return ut;return ht},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===ut&&(e&&e.eventType&Se?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=ve(),this.manager.emit(this.options.event,this._input)))}}),c(ee,K,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[it]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&at)}}),c(te,K,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Pe|_e,pointers:1},getTouchAction:function(){return $.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(Pe|_e)?t=e.overallVelocity:n&Pe?t=e.overallVelocityX:n&_e&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&he(t)>this.options.velocity&&e.eventType&Se},emit:function(e){var t=G(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),c(ne,j,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[nt]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,s=e.deltaTime<t.time;if(this.reset(),e.eventType&ke&&0===this.count)return this.failTimeout();if(i&&s&&n){if(e.eventType!=Se)return this.failTimeout();var r=this.pTime?e.timeStamp-this.pTime<t.interval:!0,a=!this.pCenter||M(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,a&&r?this.count+=1:this.count=1,this._input=e;var c=this.count%t.taps;if(0===c)return this.hasRequireFailures()?(this._timer=o(function(){this.state=ut,this.tryEmit()},t.interval,this),at):ut}return ht},failTimeout:function(){return this._timer=o(function(){this.state=ht},this.options.interval,this),ht},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ut&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ie.VERSION="2.0.6",ie.defaults={domEvents:!1,touchAction:et,enable:!0,inputTarget:null,inputClass:null,preset:[[ee,{enable:!1}],[Q,{enable:!1},["rotate"]],[te,{direction:Pe}],[$,{direction:Pe},["swipe"]],[ne],[ne,{event:"doubletap",taps:2},["tap"]],[J]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var vt=1,ft=2;oe.prototype={set:function(e){return ae(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?ft:vt},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var n,i=this.recognizers,o=t.curRecognizer;(!o||o&&o.state&ut)&&(o=t.curRecognizer=null);for(var s=0;s<i.length;)n=i[s],t.stopped===ft||o&&n!=o&&!n.canRecognizeWith(o)?n.reset():n.recognize(e),!o&&n.state&(at|ct|lt)&&(o=t.curRecognizer=n),s++}},get:function(e){if(e instanceof j)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(s(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(s(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=g(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){var n=this.handlers;return r(p(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this},off:function(e,t){var n=this.handlers;return r(p(e),function(e){t?n[e]&&n[e].splice(g(n[e],t),1):delete n[e]}),this},emit:function(e,t){this.options.domEvents&&re(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](t),i++}},destroy:function(){this.element&&se(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ae(ie,{INPUT_START:ke,INPUT_MOVE:Ce,INPUT_END:Se,INPUT_CANCEL:Ne,STATE_POSSIBLE:rt,STATE_BEGAN:at,STATE_CHANGED:ct,STATE_ENDED:lt,STATE_RECOGNIZED:ut,STATE_CANCELLED:dt,STATE_FAILED:ht,DIRECTION_NONE:Be,DIRECTION_LEFT:xe,DIRECTION_RIGHT:Oe,DIRECTION_UP:Me,DIRECTION_DOWN:De,DIRECTION_HORIZONTAL:Pe,DIRECTION_VERTICAL:_e,DIRECTION_ALL:Re,Manager:oe,Input:w,TouchAction:q,TouchInput:U,MouseInput:R,PointerEventInput:Y,TouchMouseInput:F,SingleTouchInput:z,Recognizer:j,AttrRecognizer:K,Tap:ne,Pan:$,Swipe:te,Pinch:Q,Rotate:ee,Press:J,on:h,off:v,each:r,merge:me,extend:fe,assign:ae,inherit:c,bindFn:l,prefixed:b});var mt="undefined"!=typeof e?e:"undefined"!=typeof self?self:{};mt.Hammer=ie,"function"==typeof define&&define.amd?define(function(){return ie}):"undefined"!=typeof module&&module.exports?module.exports=ie:e[n]=ie}(window,document,"Hammer"),!function(){void 0!==document.documentElement.style["touch-action"],window.Hammer=window.Hammer||{};var e=window.MutationObserver||window.WebKitMutationObserver,t=/touch-action[:][\s]*none[^;'"]*/,n=/touch-action/,i=navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?!0:!1,o=function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(t){return!1}}(),s=o&&i;window.Hammer.time={getTouchAction:function(e){return this.checkStyleString(e.getAttribute("style"))},checkStyleString:function(e){return n.test(e)?t.test(e)?"none":!0:void 0},touchHandler:function(e){if(this.hasTouchNone(e.target)&&(!s||Date.now()-e.target.lastStart<125)){if("touchend"===e.type){var t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});setTimeout(function(){e.target.dispatchEvent(t)},0)}e.preventDefault()}delete e.target.lastStart},styleWatcher:function(e){e.forEach(this.styleUpdater,this)},styleUpdater:function(e){if(e.target.updateNext)return void(e.target.updateNext=!1);var t=this.getTouchAction(e.target);return t?void("none"!==t&&(e.target.hadTouchNone=!1)):void(!t&&(e.oldValue&&this.checkStyleString(e.oldValue)||e.target.hadTouchNone)&&(e.target.hadTouchNone=!0,e.target.updateNext=!1,e.target.setAttribute("style",e.target.getAttribute("style")+" touch-action: none;")))},install:function(){document.addEventListener("touchend",this.touchHandler.bind(this),!0),document.addEventListener("mouseup",this.touchHandler.bind(this),!0),s&&document.addEventListener("touchstart",function(e){this.hasTouchNone(e.target)&&(e.target.lastStart=Date.now())}.bind(this)),this.observer=new e(this.styleWatcher.bind(this)).observe(document,{subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["style"]})}},window.Hammer.time.install()}(),!function(e,t){e.Zenscroll=function(n,i,o){i=i||999,o&&0===o||(o=9);var s,r=t.documentElement,a=function(){return n?n.scrollTop:e.scrollY||r.scrollTop},c=function(){return n?Math.min(n.offsetHeight,e.innerHeight):e.innerHeight||r.clientHeight},l=function(e){return n?e.offsetTop-n.offsetTop:e.getBoundingClientRect().top+a()-r.offsetTop},u=function(){clearTimeout(s),s=0},d=function(t,o){u();var l=a(),d=Math.max(t,0)-l;o=o||Math.min(Math.abs(d),i);var h=(new Date).getTime();!function v(){s=setTimeout(function(){var t=Math.min(((new Date).getTime()-h)/o,1),i=Math.max(Math.floor(l+d*(.5>t?2*t*t:t*(4-2*t)-1)),0);n?n.scrollTop=i:e.scrollTo(0,i),1>t&&c()+i<(n||r).scrollHeight?v():setTimeout(u,99)},9)}()},h=function(e,t){d(l(e)-o,t)},v=function(e,t){var n=e.getBoundingClientRect().height+2*o,i=c(),s=l(e),r=s+n,u=a();o>s-u||n>i?h(e,t):o>u+i-r&&d(r-i,t)},f=function(e,t,n){d(Math.max(l(e)-c()/2+(n||e.getBoundingClientRect().height/2),0),t)},m=function(t){try{history.replaceState({},"",e.location.href.split("#")[0]+(t?"#"+t:""))}catch(n){}},p=function(t){for(var n=t.target;n&&"A"!==n.tagName;)n=n.parentNode;if(n){var i=n.getAttribute("href")||"";if(0===i.indexOf("#"))if("#"===i)t.preventDefault(),e.zenscroll.toY(0),m("");else{var o=n.hash.substring(1),s=document.getElementById(o);s&&(t.preventDefault(),e.zenscroll.to(s),m(o))}}};!n&&"addEventListener"in e&&!e.noZensmooth&&e.addEventListener("click",p,!1);var g=function(e,t){e&&(i=e),null!==t&&(o=t)};return{setup:g,to:h,toY:d,intoView:v,center:f,stop:u,moving:function(){return!!s}}},e.zenscroll=new e.Zenscroll}(this,document);